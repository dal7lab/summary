<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>누적 인지 부채 (Strain Curve) 인터랙티브 시뮬레이터 V0.6</title>
    
    <!-- 1. 스타일시트 및 라이브러리 (V0.6: Mermaid.js 제거) -->
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    
    <!-- KaTeX (LaTeX 수식 렌더링) CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script>
    
    <!-- V0.6: Mermaid.js CDN 스크립트 태그 삭제 -->
    
    <style>
        /* Google Font (Inter & Nanum Gothic) */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Nanum+Gothic:wght@400;700&display=swap');
        
        body {
            font-family: 'Inter', 'Nanum Gothic', sans-serif;
            background-color: #111827;
            color: #E5E7EB;
        }
        .card {
            background-color: #1F2937;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            border: 1px solid #374151;
        }
        .card-header {
            background-color: #374151;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #4B5563;
        }
        .card-content {
            padding: 1.5rem;
            line-height: 1.75;
        }
        h1, h2, h3 {
            font-weight: 700;
        }
        
        /* 커스텀 슬라이더 스타일 */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #374151;
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
        }
        input[type=range]:hover {
            opacity: 1;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3B82F6;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #111827;
        }
        input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3B82F6;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #111827;
        }
        
        /* KaTeX 렌더링 스타일 */
        .katex-display {
            margin: 1em 0;
            color: #93C5FD;
        }
        .katex {
            font-size: 1.1em;
            color: #93C5FD;
        }
        
        /* V0.6: 텍스트 마인드맵 스타일 */
        .text-mindmap ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }
        .text-mindmap > ul > li {
            font-size: 1.1rem;
        }
        .text-mindmap strong {
            color: #E5E7EB;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto max-w-7xl p-4 md:p-8">
        
        <!-- 헤더 -->
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">누적 인지 부채 (Strain Curve)</h1>
            <p class="text-xl text-gray-400">인터랙티브 시뮬레이터 V0.6 (텍스트 마인드맵)</p>
        </header>

        <!-- 메인 그리드: 컨트롤러 + 그래프 -->
        <main class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-12">

            <!-- 1. 컨트롤러 (V0.5와 동일) -->
            <div class="lg:col-span-2 card">
                <div class="card-header">
                    <h2 class="text-2xl text-white">하루 업무 변수 시뮬레이터</h2>
                </div>
                <div class="card-content space-y-5">
                    
                    <div>
                        <label for="morningDeepWork" class="block mb-2 font-medium text-gray-300">오전 딥 워크 강도 ($L_m$)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="morningDeepWork" min="5" max="20" value="10" class="flex-1">
                            <span id="morningDeepWorkVal" class="font-mono text-lg text-blue-300 w-10 text-right">10</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">오전 집중 업무의 인지적 부하입니다.</p>
                    </div>

                    <div>
                        <label for="lunchRecovery" class="block mb-2 font-medium text-gray-300">점심 회복 효율 ($R$)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="lunchRecovery" min="10" max="40" value="25" class="flex-1">
                            <span id="lunchRecoveryVal" class="font-mono text-lg text-blue-300 w-10 text-right">25</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">휴식의 질입니다. (높을수록 부채 감소폭이 큼)</p>
                    </div>

                    <div>
                        <label for="afternoonContextSwitch" class="block mb-2 font-medium text-gray-300">오후 '멀티태스킹' 부하 ($C_s$)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="afternoonContextSwitch" min="1" max="10" value="5" class="flex-1">
                            <span id="afternoonContextSwitchVal" class="font-mono text-lg text-blue-300 w-10 text-right">5</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">오후의 잦은 이메일, 메신저 등 배경 소음 부하입니다.</p>
                    </div>
                    
                    <div class="border-t border-gray-700 pt-5">
                        <label for="meetingHours" class="block mb-2 font-medium text-yellow-300">총 회의 시간 ($M$)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="meetingHours" min="0" max="4" value="1" step="0.5" class="flex-1">
                            <span id="meetingHoursVal" class="font-mono text-lg text-yellow-300 w-10 text-right">1.0</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">하루 총 회의 시간 (시간당 15의 부하가 분배됩니다).</p>
                    </div>
                    
                    <div>
                        <label for="interruptions" class="block mb-2 font-medium text-yellow-300">긴급/돌발 업무 빈도 ($I$)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="interruptions" min="0" max="10" value="3" class="flex-1">
                            <span id="interruptionsVal" class="font-mono text-lg text-yellow-300 w-10 text-right">3</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">전화, 상사 지시 등 (건당 3의 부하가 분배됩니다).</p>
                    </div>

                    <div class="border-t border-gray-700 pt-5">
                        <label for="threshold" class="block mb-2 font-medium text-red-300">인지적 임계점 (Threshold)</label>
                        <div class="flex items-center space-x-3">
                            <input type="range" id="threshold" min="50" max="90" value="75" class="flex-1">
                            <span id="thresholdVal" class="font-mono text-lg text-red-300 w-10 text-right">75</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">'인지적 붕괴'가 시작되는 개인별 한계치입니다.</p>
                    </div>

                </div>
            </div>

            <!-- 2. 그래프 (V0.5와 동일) -->
            <div class="lg:col-span-3 card">
                <div class="card-content" style="height: 450px;">
                    <canvas id="strainChart"></canvas>
                </div>
                <div class="card-content border-t border-gray-700">
                    <p id="chartSummary" class="text-center text-gray-300 font-medium">슬라이더를 조작하여 실시간으로 그래프 변화를 확인하세요.</p>
                </div>
            </div>

        </main>

        <!-- 텍스트 콘텐츠 그리드 (V0.5와 동일) -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <!-- 1. 개념 설명 -->
            <div class="card">
                <div class="card-header">
                    <h2 class="text-2xl text-white">🌍 1. 개념 설명: 인지 부채와 누적 인지 부채</h2>
                </div>
                <div class="card-content space-y-4">
                    <p>'인지 부채(Cognitive Debt)'는 특정 순간에 발생하는 **인지적 과부하 상태**를 말합니다. 지식 노동자가 복잡한 코드를 리뷰하거나 여러 개의 데이터를 동시에 비교 분석할 때처럼, 작업 기억(Working Memory)의 한계를 초과하는 정보를 처리하려 할 때 발생하는 단기적 '부채'입니다.</p>
                    <p>반면, **'누적 인지 부채(Cognitive Strain)'**는 이러한 단기 부채들이 **제대로 상환(회복)되지 않고 시간에 따라 축적된 총량**을 의미합니다. 이는 단순한 피로를 넘어, 인지 자원이 고갈되어 가는 누적된 압력(Strain)을 나타냅니다.</p>
                    <p>지식 노동자의 인지 부채는 주로 **① 잦은 맥락 전환**(예: 코딩 중 메신저 확인), **② 지속적인 의사결정**(예: 이메일 답장, 회의)에서 발생하는 '의사결정 피로', 그리고 **③ 만성적인 작업 메모리 과부하**(예: 3개 프로젝트 동시 진행)로 인해 발생합니다.</p>
                    <p>Strain Curve는 이 누적량이 **선형적이지 않음**을 보여줍니다. 초기에는 인지적 탄력성(Resilience)으로 버티지만(안정 구간), 일정 수준의 부하가 지속되면 회복 속도보다 누적 속도가 훨씬 빨라지며 곡선이 가파르게 상승합니다(비선형 증가).</p>
                    <p>결국, 특정 **피로 역치(Threshold)**를 넘어서면, 전전두엽의 기능이 급격히 저하되어 사소한 작업도 어렵게 느껴지고 감정 조절이 힘들어지는 **'인지적 붕괴(Cognitive Collapse)'** 상태에 이르게 됩니다. 이는 단순한 휴식이 아닌, 적극적인 회복(Recovery)을 통해서만 해소될 수 있습니다.</p>
                </div>
            </div>

            <!-- 2. 함수식 기반 모델 -->
            <div class="card">
                <div class="card-header">
                    <h2 class="text-2xl text-white">📈 2. 함수식 기반 모델 (Mathematical Modeling)</h2>
                </div>
                <div class="card-content space-y-4">
                    <p>지식 노동자의 하루 동안 누적 인지 부채 $S(t)$는 시간 $t$에 따른 '인지 부하량($L$)'과 '회복률($R$)'의 적분으로 모델링할 수 있습니다.</p>
                    <div class="flex justify-center my-4">
                        $$S(t) = \int_{0}^{t} L(x) dx - \int_{0}^{t} R(x) dx$$
                    </div>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><b>$S(t)$ (Strain):</b> 시간 $t$에서의 총 누적 인지 부채.</li>
                        <li><b>$L(x)$ (Cognitive Load):</b> 시간 $x$에서의 인지 부하량.</li>
                        <li><b>$R(x)$ (Recovery):</b> 시간 $x$에서의 회복률.</li>
                    </ul>

                    <h3 class="text-xl font-semibold text-blue-300 pt-4">모델의 왜곡: 지식 노동자의 현실</h3>
                    <p>지식 노동자에게 $S(t)$가 위험하게 누적되는 주된 이유는 $L(x)$의 단순 증가보다 **'맥락 전환 비용(Switching Cost, $C_s$)'**과 **'회복의 질(Quality of $R$)'** 때문입니다.</p>
                    
                    <h4 class="text-lg font-semibold text-gray-300">1. 멀티태스킹의 함정 (비용 $C_s$의 추가)</h4>
                    <p>코딩(작업 A) 중 메신저(작업 B)를 확인하면, 총 부하량은 $L_A + L_B$가 아니라, **주의를 전환하는 데 드는 추가 비용 $C_s$**가 붙습니다. 이 $C_s$는 $S(t)$를 비선형적으로 폭증시키는 핵심 요인입니다.</p>
                    <div class="flex justify-center my-4">
                        $$L_{\text{multitasking}}(x) = L_A(x) + L_B(x) + C_s(x)$$
                    </div>

                    <h4 class="text-lg font-semibold text-gray-300">2. 회복의 부재 (낮은 $R(x)$)</h4>
                    <p>점심시간에 스마트폰으로 뉴스를 보며 식사하는 것은 $L(x)$가 0이 아닌 상태($L=2$)이며, $R(x)$ 역시 매우 낮습니다($R=1$). 이는 $S(t)$ 곡선의 하강 기울기를 완만하게 만들어, 오후 업무 시작 시 이미 높은 $S(t)$ 값에서 출발하게 만듭니다.</p>
                </div>
            </div>

            <!-- 3. 현실 사례 -->
            <div class="card">
                <div class="card-header">
                    <h2 class="text-2xl text-white">💡 3. 현실 사례 및 인사이트: 개발자 A의 하루</h2>
                </div>
                <div class="card-content space-y-4">
                    <blockquote class="border-l-4 border-blue-500 pl-4 py-2 text-lg italic text-gray-300">
                        "바쁘다(Busy)"는 것은 <b>$L(x)$가 높은 상태</b>를 의미하고,
                        "정신없고 지쳤다(Overwhelmed)"는 것은 <b>$S(t)$가 높은 상태</b>를 의미합니다.
                        지식 노동의 생산성은 투입 시간이 아니라 $S(t)$ 관리에 달려있습니다.
                    </blockquote>
                    <ul class="list-disc list-inside space-y-3 text-gray-300">
                        <li>
                            <b>사례 1 (오전 9시):</b> 개발자 A는 복잡한 알고리즘 문제(높은 $L$)에 '딥 워크(Deep Work)' 상태로 집중합니다. $S(t)$가 상승하지만, 성과(Progress)도 함께 오릅니다. (그래프 A 구간)
                        </li>
                        <li>
                            <b>사례 2 (오전 11시):</b> 슬랙 알림, 이메일, 기획 수정 요청(높은 $C_s$)이 쏟아집니다. A는 여러 작업을 오가며 처리하지만, 실제 진척은 더디고 $S(t)$는 급격히 상승합니다. (그래프 B 구간 진입)
                        </li>
                        <li>
                            <b>사례 3 (오후 4시):</b> 이미 $S(t)$가 임계점에 근접했습니다(높은 $C$ 구간). 간단한 버그 수정(낮은 $L$)에도 불구하고 평소보다 시간이 오래 걸리고, 코드 리뷰 요청에 방어적이고 날카롭게 반응합니다. 전전두엽 기능이 저하되어 논리적 사고와 감정 조절이 어려워진 상태입니다.
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 4. 회복 메커니즘 및 대응 전략 -->
            <div class="card">
                <div class="card-header">
                    <h2 class="text-2xl text-white">🧠 4. 회복 메커니즘 및 대응 전략 ($S(t)$ 관리)</h2>
                </div>
                <div class="card-content space-y-4">
                    <p>$S(t)$를 관리하는 것은 단순히 $L(x)$(업무량)를 줄이는 것이 아니라, <strong>$C_s(x)$(전환 비용)를 제거</strong>하고 <strong>$R(x)$(회복)의 질을 높이는 것</strong>입니다.</p>
                    
                    <h3 class="text-xl font-semibold text-blue-300 pt-4">심리·신경과학적 해석</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><b>Strain과 전전두엽(PFC):</b> $S(t)$가 $B, C$ 구간에 이르면, 고차원적 사고를 담당하는 <b>전전두엽 피질(PFC)의 활동이 저하</b>됩니다. 이는 의사결정, 감정 조절, 작업 기억을 관장하는 핵심 부위입니다.</li>
                        <li><b>스트레스와 코르티솔:</b> 지속적인 인지 부하는 스트레스 호르몬(코르티솔)을 분비시켜, $S(t)$ 곡선을 더욱 가파르게 만듭니다.</li>
                        <li><b>회복과 뉴로플라스틱:</b> $D$ 구간(특히 수면) 동안 뇌는 불필요한 연결을 정리하고(Synaptic Pruning), $S(t)$를 낮추며 다음 날의 인지 활동을 준비합니다.</li>
                    </ul>

                    <h3 class="text-xl font-semibold text-blue-300 pt-4">지식 노동자를 위한 대응 전략</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead class="bg-gray-700">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">전략</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">목적</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">실행 방법</th>
                                </tr>
                            </thead>
                            <tbody class="bg-gray-800 divide-y divide-gray-700">
                                <tr>
                                    <td class="px-4 py-3 font-medium text-white">$L(x)$ 관리 (부하 제어)</td>
                                    <td class="px-4 py-3 text-gray-300">높은 $L$을 감당할 수 있는 상태에서 처리</td>
                                    <td class="px-4 py-3 text-gray-300"><b>딥 워크(Deep Work):</b> $S(t)$가 낮은 오전에 핵심 업무 배치</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 font-medium text-white">$C_s(x)$ 제거 (전환 비용 최소화)</td>
                                    <td class="px-4 py-3 text-gray-300">$S(t)$의 비선형적 폭증 방지</td>
                                    <td class="px-4 py-3 text-gray-300"><b>알림 차단 및 배치(Batching):</b> 메신저/이메일 확인 시간 정하기</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 font-medium text-white">$R(x)$ 극대화 (회복의 질 향상)</td>
                                    <td class="px-4 py-3 text-gray-300">$S(t)$ 곡선을 효과적으로 하강</td>
                                    <td class="px-4 py-3 text-gray-300"><b>마이크로 휴식:</b> 뽀모도로 기법 (25분 집중, 5분 휴식)<br><b>능동적 휴식:</b> 점심시간 산책</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 5. 요약 마인드맵 (V0.6: 텍스트 리스트로 교체) -->
            <div class="card md:col-span-2">
                <div class="card-header">
                    <h2 class="text-2xl text-white">🗺️ 5. 요약 마인드맵 (Text Ver.)</h2>
                </div>
                <div class="card-content text-mindmap text-gray-300">
                    <!-- V0.6: Mermaid를 제거하고 마크다운 스타일 리스트로 대체 -->
                    <ul>
                        <li>
                            <strong class="text-lg text-blue-300">누적 인지 부채 (Strain Curve)</strong>
                            <ul>
                                <li>
                                    <strong>1. 개념 정의</strong>
                                    <ul>
                                        <li>인지 부채 (단기 과부하)</li>
                                        <li>누적 인지 부채 (Strain 총량)</li>
                                        <li>원인: 주의 분산, 의사결정 피로</li>
                                        <li>특성: 비선형성, 임계점</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>2. 수학적 모델</strong>
                                    <ul>
                                        <li>S(t)는 Load 빼기 Recovery</li>
                                        <li>L(x): 인지 부하</li>
                                        <li>R(x): 회복률</li>
                                        <li>핵심 변수: 맥락 전환 비용 (Cs)</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>3. Strain Curve 시각화</strong>
                                    <ul>
                                        <li>A: 안정 구간</li>
                                        <li>B: 비선형 증가</li>
                                        <li>C: 임계 피로</li>
                                        <li>D: 회복</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>4. 현실 적용</strong>
                                    <ul>
                                        <li>오전: Deep Work (A 구간)</li>
                                        <li>오후: 멀티태스킹 (B, C 구간)</li>
                                        <li>인사이트: '바쁨' vs '지침'</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>5. 심리/신경과학</strong>
                                    <ul>
                                        <li>전전두엽(PFC) 피로</li>
                                        <li>코르티솔 누적</li>
                                        <li>회복 (수면, 뉴로플라스틱)</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>6. 대응 전략</strong>
                                    <ul>
                                        <li>L(x) 관리: 딥 워크</li>
                                        <li>Cs(x) 제거: 알림 차단, 배치</li>
                                        <li>R(x) 극대화: 마이크로 휴식</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <!-- 
      V0.6 메인 로직 스크립트 
      - V0.5와 동일 (Mermaid 초기화 로직만 제거)
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. Mermaid.js 초기화 로직 (V0.6: 완전 삭제) ---
            
            // --- 2. KaTeX 렌더링 ---
            try {
                if (typeof renderMathInElement === 'function') {
                    renderMathInElement(document.body, {
                        delimiters: [
                            {left: "$$", right: "$$", display: true},
                            {left: "$", right: "$", display: false},
                            {left: "\\(", right: "\\)", display: false},
                            {left: "\\[", right: "\\]", display: true}
                        ]
                    });
                } else {
                    console.error("KaTeX auto-render 스크립트가 로드되지 않았습니다.");
                }
            } catch (e) {
                console.error("KaTeX 렌더링 실패:", e);
            }

            // --- 3. 차트 및 인터랙션 로직 (V0.5와 동일) ---
            try {
                if (typeof Chart === 'undefined') {
                    console.error("Chart.js가 로드되지 않았습니다.");
                    return; 
                }

                const ctx = document.getElementById('strainChart').getContext('2d');
                
                const sliders = {
                    morningDeepWork: document.getElementById('morningDeepWork'),
                    lunchRecovery: document.getElementById('lunchRecovery'),
                    afternoonContextSwitch: document.getElementById('afternoonContextSwitch'),
                    meetingHours: document.getElementById('meetingHours'),
                    interruptions: document.getElementById('interruptions'),
                    threshold: document.getElementById('threshold')
                };
                const values = {
                    morningDeepWork: document.getElementById('morningDeepWorkVal'),
                    lunchRecovery: document.getElementById('lunchRecoveryVal'),
                    afternoonContextSwitch: document.getElementById('afternoonContextSwitchVal'),
                    meetingHours: document.getElementById('meetingHoursVal'),
                    interruptions: document.getElementById('interruptionsVal'),
                    threshold: document.getElementById('thresholdVal')
                };
                const chartSummary = document.getElementById('chartSummary');

                const timeLabels = ['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00'];
                const thresholdValue = () => parseFloat(sliders.threshold.value);

                function calculateStrain(params) {
                    const { morningDeepWork, lunchRecovery, afternoonContextSwitch, meetingHours, interruptions } = params;
                    
                    const totalMeetingCost = meetingHours * 15; 
                    const totalInterruptionCost = interruptions * 3; 

                    const morningEventLoad = (totalMeetingCost / 2) * 0.4 + (totalInterruptionCost / 2) * 0.4;
                    const afternoonEventLoad = (totalMeetingCost / 2) * 0.6 + (totalInterruptionCost / 2) * 0.6;
                    
                    let strainData = [];
                    let currentStrain = 5; 
                    strainData.push(currentStrain); // 09:00

                    currentStrain += morningDeepWork + morningEventLoad * 0.5;
                    strainData.push(currentStrain); // 10:00
                    
                    currentStrain += morningDeepWork + morningEventLoad * 0.5;
                    strainData.push(currentStrain); // 11:00
                    
                    currentStrain += morningDeepWork * 0.5; 
                    strainData.push(currentStrain); // 12:00
                    
                    currentStrain -= lunchRecovery; 
                    currentStrain = Math.max(5, currentStrain);
                    strainData.push(currentStrain); // 13:00

                    currentStrain += afternoonContextSwitch + afternoonEventLoad * 0.3;
                    strainData.push(currentStrain); // 14:00
                    
                    currentStrain += afternoonContextSwitch * 1.2 + afternoonEventLoad * 0.3;
                    strainData.push(currentStrain); // 15:00
                    
                    currentStrain += afternoonContextSwitch * 1.5 + afternoonEventLoad * 0.2;
                    strainData.push(currentStrain); // 16:00 
                    
                    let eveningLoad = (currentStrain > thresholdValue()) ? 10 : 5; 
                    currentStrain += (afternoonContextSwitch * 1.2) + eveningLoad + afternoonEventLoad * 0.1;
                    strainData.push(currentStrain); // 17:00
                    
                    eveningLoad = (currentStrain > thresholdValue()) ? 12 : 3;
                    currentStrain += (afternoonContextSwitch * 0.8) + eveningLoad + afternoonEventLoad * 0.1;
                    strainData.push(currentStrain); // 18:00

                    return strainData.map(val => parseFloat(val.toFixed(1)));
                }

                function getSliderValues() {
                    return {
                        morningDeepWork: parseFloat(sliders.morningDeepWork.value),
                        lunchRecovery: parseFloat(sliders.lunchRecovery.value),
                        afternoonContextSwitch: parseFloat(sliders.afternoonContextSwitch.value),
                        meetingHours: parseFloat(sliders.meetingHours.value),
                        interruptions: parseFloat(sliders.interruptions.value),
                    };
                }

                let strainChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: timeLabels,
                        datasets: [
                            {
                                label: '누적 인지 부채 (Strain)',
                                data: calculateStrain(getSliderValues()),
                                borderColor: 'rgb(59, 130, 246)',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                            },
                            {
                                label: '인지적 임계점 (Threshold)',
                                data: Array(timeLabels.length).fill(thresholdValue()),
                                borderColor: 'rgb(239, 68, 68)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 150,
                                grid: { color: '#374151' },
                                ticks: { color: '#9CA3AF' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: '#9CA3AF' }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: { color: '#E5E7EB' }
                            }
                        },
                    }
                });

                function updateChart() {
                    values.morningDeepWork.textContent = sliders.morningDeepWork.value;
                    values.lunchRecovery.textContent = sliders.lunchRecovery.value;
                    values.afternoonContextSwitch.textContent = sliders.afternoonContextSwitch.value;
                    values.meetingHours.textContent = parseFloat(sliders.meetingHours.value).toFixed(1);
                    values.interruptions.textContent = sliders.interruptions.value;
                    values.threshold.textContent = sliders.threshold.value;

                    const newStrainData = calculateStrain(getSliderValues());
                    strainChart.data.datasets[0].data = newStrainData;
                    strainChart.data.datasets[1].data = Array(timeLabels.length).fill(thresholdValue());
                    strainChart.update('none'); 

                    const finalStrain = newStrainData[newStrainData.length - 1];
                    if (finalStrain > thresholdValue()) {
                        chartSummary.textContent = `[경고] 퇴근 시 인지 부채(${finalStrain.toFixed(0)})가 임계점(${thresholdValue()})을 초과했습니다. (번아웃 위험)`;
                        chartSummary.classList.remove('text-gray-300');
                        chartSummary.classList.add('text-red-400');
                    } else {
                        chartSummary.textContent = `[양호] 퇴근 시 인지 부채(${finalStrain.toFixed(0)})가 임계점(${thresholdValue()}) 이하로 관리되었습니다.`;
                        chartSummary.classList.remove('text-red-400');
                        chartSummary.classList.add('text-gray-300');
                    }
                }

                Object.values(sliders).forEach(slider => {
                    slider.addEventListener('input', updateChart);
                });

                updateChart();

            } catch (e) {
                console.error("Chart.js 렌더링 실패:", e);
                document.getElementById('chartSummary').textContent = "오류: 차트를 로드할 수 없습니다. Chart.js 라이브러리를 확인하세요.";
                document.getElementById('chartSummary').classList.add('text-red-400');
            }
        });
    </script>
</body>
</html>