<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ë‘ì˜ ë¯¸ë¶„ ë°©ì •ì‹ê³¼ ê´€ê³„ ê¶¤ì  ì‹œë®¬ë ˆì´í„° (v19 - Phase Plot)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts - Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- [ì‹ ê·œ] MathJax (ìˆ˜í•™ì‹ ë Œë”ë§) ì„¤ì • -->
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .gradient-text {
            background: linear-gradient(to right, #F472B6, #EC4899, #D946EF); /* Pink to Fuchsia to Purple */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .accordion-content { display: none; overflow: hidden; }
        /* [ìˆ˜ì •] ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ë†’ì´ ì¡°ì • */
        .chart-container {
            position: relative;
            height: 50vh; /* 50vh */
            width: 100%;
            min-height: 400px;
        }
        .phase-container {
            position: relative;
            height: 50vh; /* 50vh */
            width: 100%;
            min-height: 400px;
        }
        .formula {
            font-size: 1.1rem; color: #D1D5DB; background: #1F2937;
            padding: 1.5rem; border-radius: 0.5rem; overflow-x: auto; border: 1px solid #4B5563;
        }
        input[type="range"] {
            -webkit-appearance: none; appearance: none;
            width: 100%; height: 8px; background: #374151;
            border-radius: 5px; outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 20px; height: 20px; background: #EC4899;
            border-radius: 50%; cursor: pointer; transition: background 0.2s;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px; height: 20px; background: #EC4899;
            border-radius: 50%; cursor: pointer; border: none;
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="container mx-auto max-w-7xl px-4 py-16">

        <!-- í—¤ë” -->
        <header class="text-center mb-16">
            <h1 class="text-5xl md:text-6xl font-black mb-6 gradient-text">
                ê´€ê³„ ê¶¤ì  ì‹œë®¬ë ˆì´í„° (v19)
            </h1>
            <p class="text-2xl md:text-3xl font-bold text-gray-100">
                Phase Plotìœ¼ë¡œ ë³´ëŠ” ê´€ê³„ì˜ ìš´ëª…
            </p>
        </header>

        <!-- ì‹œë®¬ë ˆì´ì…˜ ë©”ì¸ (ê·¸ë¦¬ë“œ) -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- 1. ì»¨íŠ¸ë¡¤ íŒ¨ë„ (L) -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700 h-fit">
                <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.835 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.532 1.532 0 012.287-.947c1.372.835 2.942-.734 2.106-2.106a1.532 1.532 0 01-.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01.947-2.287c.835-1.372-.734-2.942-2.106-2.106A1.532 1.532 0 0111.49 3.17zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" /></svg>
                    ìš´ëª… ë³€ìˆ˜ ì¡°ì‘
                </h2>
                
                <div class="space-y-6">
                    <!-- ì´ˆê¸° ê°ì • -->
                    <div>
                        <label for="param-x0" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>ì˜í¬(x) ì´ˆê¸° ê°ì • ($x_0$)</span>
                            <span id="val-x0" class="font-bold text-pink-400 text-base">1.0</span>
                        </label>
                        <input type="range" id="param-x0" min="-2" max="2" value="1.0" step="0.1" class="w-full mt-2">
                    </div>
                    <div>
                        <label for="param-y0" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>ì² ìˆ˜(y) ì´ˆê¸° ê°ì • ($y_0$)</span>
                            <span id="val-y0" class="font-bold text-blue-400 text-base">0.5</span>
                        </label>
                        <input type="range" id="param-y0" min="-2" max="2" value="0.5" step="0.1" class="w-full mt-2" style="--thumb-color: #3B82F6;">
                    </div>

                    <!-- ìƒí˜¸ì‘ìš© ê³„ìˆ˜ -->
                    <div class="pt-4 border-t border-gray-600">
                        <label for="param-a" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>$a$ (ì˜í¬ ìê¸° ì˜í–¥)</span>
                            <span id="val-a" class="font-bold text-white text-base">-0.1</span>
                        </label>
                        <input type="range" id="param-a" min="-1" max="1" value="-0.1" step="0.05" class="w-full mt-2">
                    </div>
                    <div>
                        <label for="param-b" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>$b$ (ì² ìˆ˜ â†’ ì˜í¬)</span>
                            <span id="val-b" class="font-bold text-white text-base">0.8</span>
                        </label>
                        <input type="range" id="param-b" min="-1" max="1" value="0.8" step="0.05" class="w-full mt-2">
                    </div>
                    <div>
                        <label for="param-e" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>$e$ (ì˜í¬ â†’ ì² ìˆ˜)</span>
                            <span id="val-e" class="font-bold text-white text-base">-0.6</span>
                        </label>
                        <input type="range" id="param-e" min="-1" max="1" value="-0.6" step="0.05" class="w-full mt-2">
                    </div>
                    <div>
                        <label for="param-d" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>$d$ (ì² ìˆ˜ ìê¸° ì˜í–¥)</span>
                            <span id="val-d" class="font-bold text-white text-base">-0.2</span>
                        </label>
                        <input type="range" id="param-d" min="-1" max="1" value="-0.2" step="0.05" class="w-full mt-2">
                    </div>
                </div>

                <!-- [ìˆ˜ì •] v19 í”„ë¦¬ì…‹ (ë” ëª…í™•í•œ ì´ë¦„ê³¼ ê°’) -->
                <div class="mt-8 pt-6 border-t border-gray-600">
                    <h3 class="text-lg font-semibold text-white mb-3">ê´€ê³„ ê¶¤ì  í”„ë¦¬ì…‹</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <button id="preset-stable-boring" class="w-full px-3 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition text-sm font-medium">ì•ˆì •ì  ê¶Œíƒœê¸°</button>
                        <button id="preset-rollercoaster" class="w-full px-3 py-2 bg-pink-600 text-white rounded-lg shadow hover:bg-pink-700 transition text-sm font-medium">ê²©ì •ì  ë¡¤ëŸ¬ì½”ìŠ¤í„°</button>
                        <button id="preset-doomed" class="w-full px-3 py-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition text-sm font-medium">íŒŒêµ­ (ì„œë¡œ ì¦ì˜¤)</button>
                        <button id="preset-pushpull" class="w-full px-3 py-2 bg-purple-600 text-white rounded-lg shadow hover:bg-purple-700 transition text-sm font-medium">ì˜ì›í•œ ì¤„ë‹¤ë¦¬ê¸°</button>
                    </div>
                </div>
            </div>

            <!-- 2. ê·¸ë˜í”„ ë° í•´ì„ (R) -->
            <div class="lg:col-span-2 space-y-8">
                <!-- ì°¨íŠ¸ 1: ì‹œê°„-ê°ì • ì°¨íŠ¸ -->
                <div class="bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-4">ğŸ“ˆ ì‹œê°„ì— ë”°ë¥¸ ê°ì • ë³€í™” (t=50)</h2>
                    <div class="chart-container">
                        <canvas id="timeSeriesChart"></canvas>
                    </div>
                </div>
                
                <!-- [ì‹ ê·œ] ì°¨íŠ¸ 2: ê¶¤ì  (Phase Plot) ì°¨íŠ¸ -->
                <div class="bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-4">ğŸ”® ê´€ê³„ ê¶¤ì  (Phase Plot)</h2>
                    <div class="phase-container">
                        <canvas id="phasePlotChart"></canvas>
                    </div>
                </div>

                <!-- [ì‹ ê·œ] AI ê´€ê³„ ì»¨ì„¤íŒ… -->
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        AI ê´€ê³„ ì»¨ì„¤íŒ…
                    </h2>
                    <div id="ai-consulting-report" class="text-lg text-gray-300 leading-relaxed space-y-3">
                        <!-- JSë¡œ ë™ì  ì—…ë°ì´íŠ¸ -->
                    </div>
                </div>

                <!-- [ìˆ˜ì •] ê¸°ì¡´ ë™ì  ë¶„ì„ (ì „ë¬¸ê°€ìš©) -->
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a6 6 0 00-6 6v3.586l-1.707 1.707A1 1 0 003 15v4a1 1 0 001 1h12a1 1 0 001-1v-4a1 1 0 00-.293-.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" /></svg>
                        ì „ë¬¸ê°€ìš© ë™ê³„ì  ë¶„ì„ (v19)
                    </h2>
                    <div id="interpretation-text" class="text-lg text-gray-300 leading-relaxed space-y-3">
                        <!-- JSë¡œ ë™ì  ì—…ë°ì´íŠ¸ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. ì‹œë®¬ë ˆì´ì…˜ ì›ë¦¬ (ì•„ì½”ë””ì–¸) -->
        <section class="mt-24">
            <h2 class="text-4xl font-extrabold text-center mb-12 gradient-text">
                ì‹œë®¬ë ˆì´ì…˜ ì‘ë™ ì›ë¦¬
            </h2>
            <div class="max-w-4xl mx-auto space-y-4">
                
                <!-- [ìˆ˜ì •] v19: MathJax ì ìš© -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">1. ì„ í˜• ë¯¸ë¶„ ë°©ì •ì‹</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ì´ ì‹œë®¬ë ˆì´ì…˜ì€ ë‘ ì‚¬ëŒì˜ ê°ì • 'ë³€í™”ìœ¨'($dx/dt, dy/dt$)ì´ ë‘ ì‚¬ëŒì˜ 'í˜„ì¬ ê°ì •'($x, y$)ì— ì˜í•´ ê²°ì •ëœë‹¤ê³  ê°€ì •í•˜ëŠ” ì„ í˜• ë¯¸ë¶„ ë°©ì •ì‹ ì‹œìŠ¤í…œì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤. (ì™¸ë¶€ ì˜í–¥ $c, f$ëŠ” 0ìœ¼ë¡œ ê³ ì •)
                        </p>
                        <div class="formula">
                            $$ \frac{dx}{dt} = ax + by $$
                            $$ \frac{dy}{dt} = ex + dy $$
                        </div>
                    </div>
                </div>
                
                <!-- [ìˆ˜ì •] v19: MathJax ì ìš© -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">2. 4ê°€ì§€ í•µì‹¬ ë³€ìˆ˜ì˜ ì˜ë¯¸</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ê´€ê³„ì˜ ëª¨ë“  ìš´ëª…ì€ 4ê°œì˜ ìƒí˜¸ì‘ìš© ê³„ìˆ˜ì— ì˜í•´ ê²°ì •ë©ë‹ˆë‹¤.
                        </p>
                        <ul class="list-disc list-outside pl-6 mt-4 space-y-2">
                            <li><strong>$a$ (ì˜í¬ ìê¸° ì˜í–¥):</strong> ì˜í¬ê°€ ìì‹ ì˜ ê°ì •ì— ë¯¸ì¹˜ëŠ” ì˜í–¥. ($a < 0$: ê°ì •ì´ ì‹ìŒ, $a > 0$: ê°ì •ì´ ì¦í­)</li>
                            <li><strong>$b$ (ì² ìˆ˜ â†’ ì˜í¬):</strong> ì² ìˆ˜ì˜ ê°ì •ì´ ì˜í¬ì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥. ($b < 0$: ë¶€ì •ì , $b > 0$: ê¸ì •ì )</li>
                             <li><strong>$e$ (ì˜í¬ â†’ ì² ìˆ˜):</strong> ì˜í¬ì˜ ê°ì •ì´ ì² ìˆ˜ì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥. ($e < 0$: ë¶€ì •ì , $e > 0$: ê¸ì •ì )</li>
                            <li><strong>$d$ (ì² ìˆ˜ ìê¸° ì˜í–¥):</strong> ì² ìˆ˜ê°€ ìì‹ ì˜ ê°ì •ì— ë¯¸ì¹˜ëŠ” ì˜í–¥. ($d < 0$: ê°ì •ì´ ì‹ìŒ, $d > 0$: ê°ì •ì´ ì¦í­)</li>
                        </ul>
                    </div>
                </div>

                <!-- [ìˆ˜ì •] v19: MathJax ì ìš© -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">3. T-D í‰ë©´ ë¶„ì„</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ì „ë¬¸ê°€ëŠ” $a, b, d, e$ë¥¼ ì§ì ‘ ë³´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ê°’ë“¤ì„ ì¡°í•©í•œ ë‘ ê°œì˜ 'ì§„ì§œ ë³€ìˆ˜', $T$(Trace)ì™€ $D$(Determinant)ë¥¼ ë´…ë‹ˆë‹¤.
                        </p>
                        <div class="formula">
                            $$ T = a + d $$
                            $$ D = ad - be $$
                        </div>
                         <p class="text-gray-300 leading-relaxed my-4">
                           $T$ëŠ” ê´€ê³„ì˜ 'ì´ ì—ë„ˆì§€'ì…ë‹ˆë‹¤. $T > 0$ì´ë©´ ë°œì‚°(Unstable), $T < 0$ì´ë©´ ìˆ˜ë ´(Stable)í•©ë‹ˆë‹¤. $D$ëŠ” ê´€ê³„ì˜ 'í˜•íƒœ'ì…ë‹ˆë‹¤. $D < 0$ì´ë©´ ì—‡ê°ˆë¦¬ëŠ” ê¶¤ë„(Saddle)ê°€ ë©ë‹ˆë‹¤. ì´ $T, D$ ê°’ìœ¼ë¡œ 'ê´€ê³„ ê¶¤ì 'ì˜ ìµœì¢… í˜•íƒœê°€ ê²°ì •ë©ë‹ˆë‹¤.
                        </p>
                    </div>
                </div>

            </div>
        </section>

    </div>

    <script>
    // [ìˆ˜ì •] v19: DOMContentLoadedë¡œ ë˜í•‘
    document.addEventListener('DOMContentLoaded', function() {
        
        let timeSeriesChart; // ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ 1
        let phasePlotChart;  // [ì‹ ê·œ] ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ 2
        
        const timeSeriesCanvas = document.getElementById('timeSeriesChart')?.getContext('2d');
        const phasePlotCanvas = document.getElementById('phasePlotChart')?.getContext('2d');
        const interpretationText = document.getElementById('interpretation-text');
        const aiConsultingReport = document.getElementById('ai-consulting-report'); // [ì‹ ê·œ]

        if (!timeSeriesCanvas || !phasePlotCanvas) {
            console.error("ì°¨íŠ¸ ìº”ë²„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        // --- ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ (v15ì™€ ë™ì¼) ---
        function runSimulation(params, t_max = 50, dt = 0.05) {
            let x = params.x0;
            let y = params.y0;
            const { a, b, e, d, c, f } = params;

            const t_labels = [];
            const x_history = [];
            const y_history = [];

            for (let t = 0; t <= t_max; t += dt) {
                t_labels.push(t.toFixed(1));
                x_history.push(x);
                y_history.push(y);

                const dx_dt = a * x + b * y + c;
                const dy_dt = e * x + d * y + f;

                x = x + dx_dt * dt;
                y = y + dy_dt * dt;
            }
            return { t_labels, x_history, y_history };
        }

        // --- ì°¨íŠ¸ 1: ì‹œê°„-ê°ì • ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ---
        function updateTimeSeriesChart(data) {
            if (timeSeriesChart) {
                timeSeriesChart.data.labels = data.t_labels;
                timeSeriesChart.data.datasets[0].data = data.x_history;
                timeSeriesChart.data.datasets[1].data = data.y_history;
                timeSeriesChart.update();
            } else {
                timeSeriesChart = new Chart(timeSeriesCanvas, {
                    type: 'line',
                    data: {
                        labels: data.t_labels,
                        datasets: [
                            {
                                label: 'ì˜í¬ (x) ê°ì •',
                                data: data.x_history,
                                borderColor: '#EC4899', // Pink
                                backgroundColor: '#EC489930',
                                borderWidth: 3,
                                fill: false,
                                tension: 0.1
                            },
                            {
                                label: 'ì² ìˆ˜ (y) ê°ì •',
                                data: data.y_history,
                                borderColor: '#3B82F6', // Blue
                                backgroundColor: '#3B82F630',
                                borderWidth: 3,
                                fill: false,
                                tension: 0.1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top', labels: { color: '#E5E7EB', font: { size: 14 } } },
                            tooltip: { mode: 'index', intersect: false, callbacks: { title: (tooltipItems) => `Time: ${tooltipItems[0].label}s` } }
                        },
                        scales: {
                            x: { title: { display: true, text: 'ì‹œê°„ (Time)', color: '#9CA3AF' }, ticks: { color: '#9CA3AF' }, grid: { color: '#374151' } },
                            y: { title: { display: true, text: 'ê°ì • ìˆ˜ì¤€ (Emotional Level)', color: '#9CA3AF' }, ticks: { color: '#9CA3AF' }, grid: { color: '#374151' } }
                        },
                        elements: { point: { radius: 0, hitRadius: 10, hoverRadius: 5 } }
                    }
                });
            }
        }
        
        // --- [ì‹ ê·œ] ì°¨íŠ¸ 2: ê¶¤ì  (Phase Plot) ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ---
        function updatePhasePlotChart(data) {
            // Phase plotì€ (x, y) ì¢Œí‘œë¡œë§Œ êµ¬ì„±ë¨
            const phaseData = data.x_history.map((x, index) => ({ x: x, y: data.y_history[index] }));
            
            if (phasePlotChart) {
                phasePlotChart.data.datasets[0].data = phaseData;
                phasePlotChart.update();
            } else {
                phasePlotChart = new Chart(phasePlotCanvas, {
                    type: 'scatter', // ì‚°ì ë„ (ì„ ìœ¼ë¡œ ì—°ê²°)
                    data: {
                        datasets: [
                            {
                                label: 'ê´€ê³„ ê¶¤ì  (ì˜í¬ vs ì² ìˆ˜)',
                                data: phaseData,
                                borderColor: '#A78BFA', // Purple
                                borderWidth: 2.5,
                                fill: false,
                                tension: 0.1,
                                showLine: true, // ì„  ì—°ê²°
                                pointRadius: 0 // ì  ìˆ¨ê¸°ê¸°
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top', labels: { color: '#E5E7EB', font: { size: 14 } } },
                            tooltip: { 
                                mode: 'nearest', 
                                intersect: false,
                                callbacks: {
                                    title: () => 'ê°ì • ì¢Œí‘œ',
                                    label: (context) => `(ì˜í¬: ${context.parsed.x.toFixed(2)}, ì² ìˆ˜: ${context.parsed.y.toFixed(2)})`
                                }
                            }
                        },
                        scales: {
                            // Xì¶•: ì˜í¬
                            x: { 
                                title: { display: true, text: 'ì˜í¬ (x) ê°ì •', color: '#EC4899' }, 
                                ticks: { color: '#9CA3AF' }, 
                                grid: { color: '#374151' },
                                grace: '10%' // ì¶• ì—¬ìœ  ê³µê°„
                            },
                            // Yì¶•: ì² ìˆ˜
                            y: { 
                                title: { display: true, text: 'ì² ìˆ˜ (y) ê°ì •', color: '#3B82F6' }, 
                                ticks: { color: '#9CA3AF' }, 
                                grid: { color: '#374151' },
                                grace: '10%'
                            }
                        },
                        elements: {
                            point: { radius: 0, hitRadius: 10, hoverRadius: 5 }
                        }
                    }
                });
            }
        }


        /**
         * [v19] AI ì»¨ì„¤íŒ… + ì „ë¬¸ê°€ ë¶„ì„
         */
        function updateAnalysis(params) {
            const { a, b, e, d } = params;
            const T = a + d; // Trace
            const D = a * d - b * e; // Determinant
            const D_sqrt = T * T - 4 * D; // íŒë³„ì‹

            let expertAnalysis = "";
            let aiConsulting = "";
            let relationshipType = "";

            if (D < 0) {
                // --- 1. Saddle Point ---
                relationshipType = "ì—‡ê°ˆë¦¬ëŠ” ìš´ëª… (Saddle Point)";
                expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (D < 0)<br>ê¶¤ì ì€ íŠ¹ì • ì§€ì (í‰í˜•ì )ì„ í–¥í•´ ê°”ë‹¤ê°€, ë‹¤ì‹œ ë©€ì–´ì§€ëŠ” ë§ ì•ˆì¥ ëª¨ì–‘ì…ë‹ˆë‹¤. ì´ˆê¸° ì¡°ê±´($x_0, y_0$)ì— ê·¹ë„ë¡œ ë¯¼ê°í•˜ë©°, ì‚¬ì†Œí•œ ê°ì • ë³€í™”ê°€ ì™„ì „íˆ ë‹¤ë¥¸ ê²°ë§(í•œ ëª…ì€ ê¸ì •, í•œ ëª…ì€ ë¶€ì •)ì„ ì´ˆë˜í•©ë‹ˆë‹¤.`;
                aiConsulting = `
                    <p class="font-bold text-lg text-yellow-300">${relationshipType}</p>
                    <p><strong>ì§„ë‹¨:</strong> ë‘ ì‚¬ëŒì˜ ê´€ê³„ëŠ” 'ì¤„íƒ€ê¸°'ì™€ ê°™ìŠµë‹ˆë‹¤. í˜„ì¬ëŠ” ì•„ìŠ¬ì•„ìŠ¬í•˜ê²Œ ê· í˜•ì„ ì¡ê³  ìˆì§€ë§Œ, í•œìª½ìœ¼ë¡œ ê°ì •ì´ ì¡°ê¸ˆë§Œ ì ë¦¬ë©´ ê²‰ì¡ì„ ìˆ˜ ì—†ì´ ë©€ì–´ì§‘ë‹ˆë‹¤.</p>
                    <p><strong>ì²˜ë°©:</strong> $D = ad-be < 0$ì€ ë‘ ì‚¬ëŒì˜ ìƒí˜¸ì‘ìš©($b, e$)ì´ ë„ˆë¬´ ê°•í•˜ê±°ë‚˜, ìê¸° ì˜í–¥($a, d$)ê³¼ ë¶€í˜¸ê°€ ë°˜ëŒ€ì¼ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ê´€ê³„ì˜ 'ì•ˆì •ì„±'($T=a+d$)ì„ ë†’ì´ëŠ” ê²ƒì´ ì‹œê¸‰í•©ë‹ˆë‹¤. ì„œë¡œì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì¤„ì´ê±°ë‚˜, ê°ìì˜ ê°ì •($a, d$)ì´ ì•ˆì •(ìŒìˆ˜)ë˜ë„ë¡ ë…¸ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.</p>`;
            
            } else { // D >= 0
                if (T < -0.01) { // --- 2. Stable ---
                    if (D_sqrt >= 0) {
                        relationshipType = "ì•ˆì •ì  ê¶Œíƒœê¸° (Stable Node)";
                        expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (T < 0, D > 0, íŒë³„ì‹ $\ge$ 0)<br>ê°ì •ì˜ ì§„ë™ ì—†ì´, ë‘ ì‚¬ëŒì˜ ê°ì •ì€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì•ˆì •ì ì¸ 0 (ë¬´ê´€ì‹¬)ìœ¼ë¡œ ì ì°¨ ìˆ˜ë ´í•©ë‹ˆë‹¤. ê¶¤ì ì€ í‰í˜•ì ìœ¼ë¡œ ì§ì„ ì ìœ¼ë¡œ ë¹¨ë ¤ ë“¤ì–´ê°‘ë‹ˆë‹¤.`;
                        aiConsulting = `
                            <p class="font-bold text-lg text-blue-300">${relationshipType}</p>
                            <p><strong>ì§„ë‹¨:</strong> ê°€ì¥ 'ì•ˆì •ì ì¸' ê´€ê³„ì…ë‹ˆë‹¤. ($T < 0$) í° ì‹¸ì›€ì´ë‚˜ ê°ˆë“± ì—†ì´ ì”ì”í•˜ê²Œ í˜ëŸ¬ê°‘ë‹ˆë‹¤. í•˜ì§€ë§Œ, 'ì•ˆì •'ì€ ê³§ 'ë¬´ê´€ì‹¬'($x=0, y=0$)ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê¶¤ì  ì°¨íŠ¸ì—ì„œ ë³´ë“¯ì´, ë‘ ì‚¬ëŒì˜ ê°ì •ì€ (0,0) ì§€ì ìœ¼ë¡œ ìˆ˜ë ´í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                            <p><strong>ì²˜ë°©:</strong> í˜„ì¬ $T = a+d$ ê°’ì´ ë„ˆë¬´ ë‚®ìŠµë‹ˆë‹¤. ì¦‰, ë‘ ì‚¬ëŒì˜ ìê¸° ì˜í–¥($a, d$)ì´ ë„ˆë¬´ ì–µì œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê´€ê³„ì— ìƒˆë¡œìš´ 'ìê·¹'($c, f$ ê°™ì€ ì™¸ë¶€ ì´ë²¤íŠ¸)ì„ ì£¼ê±°ë‚˜, ì„œë¡œì— ëŒ€í•œ ê¸ì •ì  ì˜í–¥($b, e$)ì„ ë†’ì—¬ $T$ê°’ì„ 0ì— ê°€ê¹ê²Œ ë†’ì´ë ¤ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>`;
                    
                    } else {
                        relationshipType = "ì•ˆì •ì  ì»¤í”Œ (Stable Spiral)";
                        expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (T < 0, D > 0, íŒë³„ì‹ < 0)<br>ì•½ê°„ì˜ ê°ì • ê¸°ë³µ(ì§„ë™)ì„ ê²ªìœ¼ë©°, ë‘ ì‚¬ëŒì˜ ê°ì •ì€ ê²°êµ­ ì•ˆì •ì ì¸ 0 (ë¬´ê´€ì‹¬)ìœ¼ë¡œ ìˆ˜ë ´í•©ë‹ˆë‹¤. ê¶¤ì ì´ ì†Œìš©ëŒì´ë¥¼ ê·¸ë¦¬ë©° ì¤‘ì‹¬ìœ¼ë¡œ ë¹¨ë ¤ ë“¤ì–´ê°‘ë‹ˆë‹¤.`;
                         aiConsulting = `
                            <p class="font-bold text-lg text-blue-400">${relationshipType}</p>
                            <p><strong>ì§„ë‹¨:</strong> 'ì•ˆì •ì  ê¶Œíƒœê¸°'ì™€ ìœ ì‚¬í•˜ê²Œ (0,0)ìœ¼ë¡œ ìˆ˜ë ´($T < 0$)í•˜ì§€ë§Œ, ê·¸ ê³¼ì •ì´ ë°‹ë°‹í•˜ì§€ ì•Šê³  ì•½ê°„ì˜ 'ì§„ë™'ì„ ê²ªìŠµë‹ˆë‹¤. ì„œë¡œ ë°€ê³  ë‹¹ê¸°ë©° ê°ì •ì´ ì˜¤ë¥´ë½ë‚´ë¦¬ë½í•˜ì§€ë§Œ, ê²°êµ­ ê·¸ ì§„í­ì´ ì¤„ì–´ë“¤ë©° ì•ˆì • ìƒíƒœë¡œ ê°‘ë‹ˆë‹¤.</p>
                            <p><strong>ì²˜ë°©:</strong> ê°ˆë“±ì„ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì‹­ì‹œì˜¤. í˜„ì¬ì˜ 'ì§„ë™'ì€ ê´€ê³„ë¥¼ ê±´ê°•í•˜ê²Œ ìœ ì§€í•˜ëŠ” ë™ë ¥ì…ë‹ˆë‹¤. ë‹¤ë§Œ, ì´ ì§„ë™ì´ ê¸ì •ì ì¸ ë°©í–¥ìœ¼ë¡œ ê°€ë„ë¡ ìƒí˜¸ ì˜í–¥ë ¥($b, e$)ì„ ì¡°ì ˆí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>`;
                    }
                } else if (T > 0.01) { // --- 3. Unstable ---
                    if (D_sqrt >= 0) {
                        relationshipType = "íŒŒêµ­ (Unstable Node)";
                        expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (T > 0, D > 0, íŒë³„ì‹ $\ge$ 0)<br>ê°ì •ì˜ ì§„ë™ ì—†ì´, ë‘ ì‚¬ëŒì˜ ê°ì •ì€ ì„œë¡œë¥¼ ì¦í­ì‹œí‚¤ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ê¸ì •ì (ë˜ëŠ” ë¶€ì •ì )ìœ¼ë¡œ ë¬´í•œíˆ ë°œì‚°í•©ë‹ˆë‹¤. ê¶¤ì ì´ í‰í˜•ì ì—ì„œ ì§ì„ ì ìœ¼ë¡œ íŠ•ê²¨ ë‚˜ê°‘ë‹ˆë‹¤.`;
                        aiConsulting = `
                            <p class="font-bold text-lg text-red-500">${relationshipType}</p>
                            <p><strong>ì§„ë‹¨:</strong> 'ì—´ì •'ê³¼ 'ì¦ì˜¤'ê°€ ê³µì¡´í•˜ëŠ” ê´€ê³„ì…ë‹ˆë‹¤. ë‘ ì‚¬ëŒì˜ ê°ì • ì—ë„ˆì§€ê°€ ë„ˆë¬´ ë†’ì•„($T > 0$), ì„œë¡œë¥¼ ë§Œë‚˜ë©´ ê°ì •ì´ ë¬´í•œíˆ ì¦í­ë©ë‹ˆë‹¤. ê¸ì •ì ì¸ $x_0, y_0$ì—ì„œ ì‹œì‘í•˜ë©´ ëì—†ëŠ” ì‚¬ë‘ìœ¼ë¡œ, ë¶€ì •ì ì¸ $x_0, y_0$ì—ì„œ ì‹œì‘í•˜ë©´ ëì—†ëŠ” ì¦ì˜¤ë¡œ ë°œì‚°í•©ë‹ˆë‹¤.</p>
                            <p><strong>ì²˜ë°©:</strong> $T = a+d > 0$ì´ ë¬¸ì œì…ë‹ˆë‹¤. ê°ìì˜ 'ìê¸° ì¦í­'($a, d$) ì„±í–¥ì´ ë„ˆë¬´ ê°•í•©ë‹ˆë‹¤. ê°ì •ì„ ìŠ¤ìŠ¤ë¡œ ì‹íˆëŠ”($a, d$ë¥¼ ìŒìˆ˜ë¡œ ë§Œë“œëŠ”) 'ì¿¨ë‹¤ìš´'ì´ í•„ìš”í•©ë‹ˆë‹¤. ì„œë¡œì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥($b, e$)ì„ ì¤„ì´ëŠ” ê²ƒë„ ë°©ë²•ì…ë‹ˆë‹¤.</p>`;
                   
                    } else {
                        relationshipType = "ê²©ì •ì  ë¡¤ëŸ¬ì½”ìŠ¤í„° (Unstable Spiral)";
                        expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (T > 0, D > 0, íŒë³„ì‹ < 0)<br>ë‘ ì‚¬ëŒì˜ ê°ì •ì€ ê²©ë ¬í•œ ê¸°ë³µ(ì§„ë™)ì„ ê²ªìœ¼ë©°, ê·¸ ì§„í­ì´ ì ì  ì»¤ì§€ë©´ì„œ ê·¹ë‹¨ì ìœ¼ë¡œ ë°œì‚°í•©ë‹ˆë‹¤. ê¶¤ì ì´ ì¤‘ì‹¬ì—ì„œ ë°–ìœ¼ë¡œ í’€ë ¤ë‚˜ê°€ëŠ” ì†Œìš©ëŒì´ ëª¨ì–‘ì…ë‹ˆë‹¤.`;
                        aiConsulting = `
                            <p class="font-bold text-lg text-pink-500">${relationshipType}</p>
                            <p><strong>ì§„ë‹¨:</strong> ê°€ì¥ ë“œë¼ë§ˆí‹±í•œ ê´€ê³„ì…ë‹ˆë‹¤. ($T > 0$, ë³µì†Œê·¼) ì‚¬ë‘ê³¼ ì‹¸ì›€ì„ ê²©ë ¬í•˜ê²Œ ë°˜ë³µí•˜ë©°, ê·¸ ì§„í­ì´ ì ì  ì»¤ì§‘ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ë¶ˆê°™ì´ ì‚¬ë‘í•˜ë‹¤ê°€, ë‚´ì¼ì€ ë¶ˆê°™ì´ ì‹¸ì›ë‹ˆë‹¤. ê¶¤ì  ì°¨íŠ¸ê°€ ì´ 'ë¡¤ëŸ¬ì½”ìŠ¤í„°'ë¥¼ ëª…í™•í•˜ê²Œ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
                            <p><strong>ì²˜ë°©:</strong> ì´ ê´€ê³„ëŠ” 'íŒŒêµ­'ë³´ë‹¤ ë” ìœ„í—˜í•©ë‹ˆë‹¤. ê°ì • ì†Œëª¨ê°€ ê·¹ì‹¬í•©ë‹ˆë‹¤. ê´€ê³„ë¥¼ ìœ ì§€í•˜ë ¤ë©´ $T = a+d$ ê°’ì„ 0 ë¯¸ë§Œìœ¼ë¡œ ë‚®ì¶°ì•¼ í•©ë‹ˆë‹¤. ê°ì ê°ì •ì„ ì–µì œ($a, d$ë¥¼ ìŒìˆ˜ë¡œ)í•˜ëŠ” ê²ƒì´ ìœ ì¼í•œ í•´ê²°ì±…ì…ë‹ˆë‹¤.</p>`;
                    }
                } else { // --- 4. Center ---
                    relationshipType = "ì˜ì›í•œ ì¤„ë‹¤ë¦¬ê¸° (Center)";
                    expertAnalysis = `ì´ ì¡°í•©ì€ <strong>'${relationshipType}'</strong> ìœ í˜•ì…ë‹ˆë‹¤. (T â‰ˆ 0, D > 0)<br>ê°ì •ì´ ì•ˆì •ë˜ê±°ë‚˜ ë°œì‚°í•˜ì§€ ì•Šê³ , ì´ˆê¸° ì¡°ê±´ì— ë”°ë¼ ì¼ì •í•œ ì£¼ê¸°ë¥¼ ê·¸ë¦¬ë©° ì˜ì›íˆ ì§„ë™í•©ë‹ˆë‹¤. ê¶¤ì ì€ ë‹«íŒ íƒ€ì›í˜•ì„ ê·¸ë¦½ë‹ˆë‹¤.`;
                    aiConsulting = `
                        <p class="font-bold text-lg text-purple-400">${relationshipType}</p>
                        <p><strong>ì§„ë‹¨:</strong> ê³ ì „ì ì¸ 'ë¡œë¯¸ì˜¤ì™€ ì¤„ë¦¬ì—£' ëª¨ë¸ì…ë‹ˆë‹¤. ë‘ ì‚¬ëŒì˜ ê°ì • ì—ë„ˆì§€ê°€ ì •í™•íˆ 0($T \approx 0$)ì´ ë˜ì–´, ê°ì •ì´ ìˆ˜ë ´í•˜ì§€ë„ ë°œì‚°í•˜ì§€ë„ ì•Šê³  ì˜ì›íˆ 'ì¤„ë‹¤ë¦¬ê¸°'ë¥¼ í•©ë‹ˆë‹¤. ê¶¤ì  ì°¨íŠ¸ê°€ ë‹«íŒ ì›(í˜¹ì€ íƒ€ì›)ì´ ë©ë‹ˆë‹¤.</p>
                        <p><strong>ì²˜ë°©:</strong> ì´ ê´€ê³„ëŠ” ì™¸ë¶€ ì¶©ê²©($c, f$)ì— ë§¤ìš° ì·¨ì•½í•©ë‹ˆë‹¤. ($T$ê°€ 0ì´ë¯€ë¡œ) ì‘ì€ ìŠ¤íŠ¸ë ˆìŠ¤ì—ë„ $T < 0$ (ê¶Œíƒœê¸°)ì´ ë˜ê±°ë‚˜ $T > 0$ (ë¡¤ëŸ¬ì½”ìŠ¤í„°)ê°€ ë˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ê´€ê³„ë¥¼ ì•ˆì •ì‹œí‚¤ë ¤ë©´ $a, d$ ê°’ì„ ì•½ê°„ ìŒìˆ˜ë¡œ ì¡°ì ˆí•˜ì—¬ 'ì•ˆì •ì  ì»¤í”Œ'ë¡œ ì´í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>`;
                }
            }

            expertAnalysis += `<p class="text-sm text-gray-400 mt-2">(Trace $T = ${T.toFixed(3)}$, Determinant $D = ${D.toFixed(3)}$)</p>`;
            
            interpretationText.innerHTML = expertAnalysis;
            aiConsultingReport.innerHTML = aiConsulting;
            
            // [v19] ë™ì  ë Œë”ë§ í›„ MathJax ì¬ì‹¤í–‰
            if (window.MathJax) {
                MathJax.typesetPromise([interpretationText, aiConsultingReport]).catch(function (err) {
                    console.log('MathJax typeset error:', err);
                });
            }
        }


        // --- ì»¨íŠ¸ë¡¤ëŸ¬ ---
        const inputs = {
            a: document.getElementById('param-a'),
            b: document.getElementById('param-b'),
            e: document.getElementById('param-e'),
            d: document.getElementById('param-d'),
            x0: document.getElementById('param-x0'),
            y0: document.getElementById('param-y0'),
        };

        const values = {
            a: document.getElementById('val-a'),
            b: document.getElementById('val-b'),
            e: document.getElementById('val-e'),
            d: document.getElementById('val-d'),
            x0: document.getElementById('val-x0'),
            y0: document.getElementById('val-y0'),
        };

        // ìŠ¬ë¼ì´ë” ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
        for (const key in inputs) {
            inputs[key].addEventListener('input', (event) => {
                const value = parseFloat(event.target.value).toFixed(key.length > 2 ? 1 : 2);
                values[key].textContent = value;
                runFullSimulation(); // ìŠ¬ë¼ì´ë” ì¡°ì‘ ì‹œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë‹¤ì‹œ ì‹¤í–‰
            });
        }
        
        // í˜„ì¬ ìŠ¬ë¼ì´ë” ê°’ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
        function runFullSimulation() {
            const params = {
                a: parseFloat(inputs.a.value),
                b: parseFloat(inputs.b.value),
                e: parseFloat(inputs.e.value),
                d: parseFloat(inputs.d.value),
                x0: parseFloat(inputs.x0.value),
                y0: parseFloat(inputs.y0.value),
                c: 0, // ì™¸ë¶€ ìš”ì¸ c, fëŠ” 0ìœ¼ë¡œ ê³ ì •
                f: 0
            };
            
            const data = runSimulation(params);
            updateTimeSeriesChart(data);
            updatePhasePlotChart(data); // [ì‹ ê·œ]
            updateAnalysis(params); // [ìˆ˜ì •] v19 (ì»¨ì„¤íŒ… í¬í•¨)
        }
        
        // [ìˆ˜ì •] v19: í”„ë¦¬ì…‹ ë²„íŠ¼ ë¡œì§ (ìƒˆë¡œìš´ ê°’)
        function setParams(p) {
            Object.keys(p).forEach(key => {
                if(inputs[key]) {
                    inputs[key].value = p[key];
                    const value = p[key].toFixed(key.length > 2 ? 1 : 2);
                    values[key].textContent = value;
                }
            });
            runFullSimulation();
        }

        // T < 0, D > 0, T^2-4D > 0 (Stable Node)
        document.getElementById('preset-stable-boring').addEventListener('click', () => {
            setParams({ a: -0.5, b: 0.2, e: 0.2, d: -0.5, x0: 2.0, y0: 1.5 });
        });
        
        // T > 0, D > 0, T^2-4D < 0 (Unstable Spiral)
        document.getElementById('preset-rollercoaster').addEventListener('click', () => {
            setParams({ a: 0.1, b: 0.8, e: -0.6, d: 0.1, x0: 0.5, y0: 0.5 });
        });

        // T > 0, D > 0, T^2-4D > 0 (Unstable Node)
        document.getElementById('preset-doomed').addEventListener('click', () => {
            setParams({ a: 0.4, b: 0.1, e: 0.1, d: 0.2, x0: -1.0, y0: -0.5 });
        });
        
        // T â‰ˆ 0, D > 0 (Center)
        document.getElementById('preset-pushpull').addEventListener('click', () => {
            setParams({ a: 0.0, b: -0.8, e: 0.5, d: 0.0, x0: 2.0, y0: 0.0 });
        });


        // --- ì•„ì½”ë””ì–¸ ìŠ¤í¬ë¦½íŠ¸ ---
        document.querySelectorAll('.accordion-button').forEach(button => {
            button.addEventListener('click', () => {
                const content = button.nextElementSibling;
                const icon = button.querySelector('svg');
                const isOpening = content.style.display !== 'block';
                
                // ëª¨ë“  ì•„ì½”ë””ì–¸ ë‹«ê¸° (í…œí”Œë¦¿ ìŠ¤íƒ€ì¼)
                document.querySelectorAll('.accordion-content').forEach(c => {
                    c.style.display = 'none';
                    c.previousElementSibling.querySelector('svg').style.transform = 'rotate(0deg)';
                });

                if (isOpening) {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    // [v19] MathJax ë™ì  ë Œë”ë§ (ì•„ì½”ë””ì–¸ ì—´ë¦´ ë•Œ)
                    if (window.MathJax) {
                        MathJax.typesetPromise([content]).catch(function (err) {
                            console.log('MathJax typeset error:', err);
                        });
                    }
                }
            });
        });

        // --- ì´ˆê¸° ì‹¤í–‰ ---
        setParams({ a: 0.1, b: 0.8, e: -0.6, d: 0.1, x0: 0.5, y0: 0.5 }); // 'ë¡¤ëŸ¬ì½”ìŠ¤í„°'ë¡œ ì´ˆê¸°í™”

    });
    </script>
</body>
</html>