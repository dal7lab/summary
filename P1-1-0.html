<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìŠµ ì„±ì¥ ê³¡ì„  ì‹œë®¬ë ˆì´í„° (v7 - AI ì»¨ì„¤íŒ…)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts - Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .gradient-text {
            /* Blue to Teal Gradient */
            background: linear-gradient(to right, #38BDF8, #2DD4BF, #34D399); 
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .accordion-content { display: none; overflow: hidden; }
        .chart-container { position: relative; height: 60vh; width: 100%; min-height: 450px; }
        .formula {
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.25rem; color: #D1D5DB; background: #1F2937;
            padding: 1.5rem; border-radius: 0.5rem; overflow-x: auto; border: 1px solid #4B5563;
        }
        input[type="range"] {
            -webkit-appearance: none; appearance: none;
            width: 100%; height: 8px; background: #374151;
            border-radius: 5px; outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 20px; height: 20px; background: #2DD4BF; /* accent-teal-500 */
            border-radius: 50%; cursor: pointer; transition: background 0.2s;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px; height: 20px; background: #2DD4BF;
            border-radius: 50%; cursor: pointer; border: none;
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="container mx-auto max-w-7xl px-4 py-16">

        <!-- í—¤ë” -->
        <header class="text-center mb-16">
            <h1 class="text-5xl md:text-6xl font-black mb-6 gradient-text">
                ë¡œì§€ìŠ¤í‹± ì„±ì¥ ì‹œë®¬ë ˆì´í„°
            </h1>
            <p class="text-2xl md:text-3xl font-bold text-gray-100">
                (Python ë¡œì§ ê¸°ë°˜ v7)
            </p>
        </header>

        <!-- ì‹œë®¬ë ˆì´ì…˜ ë©”ì¸ (ê·¸ë¦¬ë“œ) -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- 1. ì»¨íŠ¸ë¡¤ íŒ¨ë„ (L) -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700 h-fit">
                <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.835 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.532 1.532 0 012.287-.947c1.372.835 2.942-.734 2.106-2.106a1.532 1.532 0 01-.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01.947-2.287c.835-1.372-.734-2.942-2.106-2.106A1.532 1.532 0 0111.49 3.17zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" /></svg>
                    ì¼ì¼ í•™ìŠµ ë³€ìˆ˜
                </h2>
                
                <div class="space-y-6">
                    <div>
                        <label for="param-total_time" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>ì´ í•™ìŠµ ì‹œê°„ (T_d)</span>
                            <span id="val-total_time" class="font-bold text-sky-300 text-base">12.0 ì‹œê°„</span>
                        </label>
                        <p class="text-xs text-gray-400 mt-2">í•˜ë£¨ì— íˆ¬ìí•˜ëŠ” ì´ ì‹œê°„ì…ë‹ˆë‹¤.</p>
                        <input type="range" id="param-total_time" min="0" max="16" value="12.0" step="0.5" class="w-full mt-2">
                    </div>

                    <div>
                        <label for="param-focus_level" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>í•™ìŠµ ëª°ì…ë„ (F_p)</span>
                            <span id="val-focus_level" class="font-bold text-sky-300 text-base">95 %</span>
                        </label>
                        <p class="text-xs text-gray-400 mt-2">í•™ìŠµ ì‹œê°„ ì¤‘ ì‹¤ì œ ëª°ì…í•œ ë¹„ìœ¨ì…ë‹ˆë‹¤. (0.0 ~ 1.0)</p>
                        <input type="range" id="param-focus_level" min="0" max="1" value="0.95" step="0.01" class="w-full mt-2">
                    </div>

                    <div>
                        <label for="param-continuous_time" class="flex justify-between items-center text-sm font-medium text-gray-300">
                            <span>ìµœëŒ€ ì—°ì† í•™ìŠµ ì‹œê°„ (T_c)</span>
                            <span id="val-continuous_time" class="font-bold text-sky-300 text-base">2.8 ì‹œê°„</span>
                        </label>
                        <p class="text-xs text-gray-400 mt-2">ì‰¬ì§€ ì•Šê³  í•œ ë²ˆì— ì§‘ì¤‘í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤. (ì—°ì† ë³´ë„ˆìŠ¤)</p>
                        <input type="range" id="param-continuous_time" min="0" max="4" value="2.8" step="0.1" class="w-full mt-2">
                    </div>
                </div>

                <!-- ê³ ê¸‰ ì„¤ì • -->
                <div class="mt-8 pt-6 border-t border-gray-600">
                    <h3 class="text-lg font-semibold text-white mb-3">ê³ ê¸‰ ì„¤ì • (ì‹œë®¬ë ˆì´ì…˜ ìƒìˆ˜)</h3>
                    <div class="space-y-6">
                         <div>
                            <label for="param-A0" class="flex justify-between items-center text-sm font-medium text-gray-300">
                                <span>ì´ˆê¸° ëŠ¥ë ¥ì¹˜ (Aâ‚€)</span>
                                <span id="val-A0" class="font-bold text-white text-base">1</span>
                            </label>
                            <input type="range" id="param-A0" min="1" max="100" value="1" step="1" class="w-full mt-2">
                        </div>
                        <div>
                            <label for="param-L" class="flex justify-between items-center text-sm font-medium text-gray-300">
                                <span>ìµœëŒ€ ëŠ¥ë ¥ì¹˜ (L)</span>
                                <span id="val-L" class="font-bold text-white text-base">1000</span>
                            </label>
                            <input type="range" id="param-L" min="500" max="2000" value="1000" step="50" class="w-full mt-2">
                        </div>
                        <div>
                            <label for="param-B" class="flex justify-between items-center text-sm font-medium text-gray-300">
                                <span>ê¸°ë³¸ í•™ìŠµ íš¨ìœ¨ (B)</span>
                                <span id="val-B" class="font-bold text-white text-base">0.010</span>
                            </label>
                            <input type="range" id="param-B" min="0.001" max="0.05" value="0.01" step="0.001" class="w-full mt-2">
                        </div>
                        <div>
                            <label for="param-wc" class="flex justify-between items-center text-sm font-medium text-gray-300">
                                <span>ì—°ì† ë³´ë„ˆìŠ¤ ê°€ì¤‘ì¹˜ (w_c)</span>
                                <span id="val-wc" class="font-bold text-white text-base">0.25</span>
                            </label>
                            <input type="range" id="param-wc" min="0" max="1" value="0.25" step="0.01" class="w-full mt-2">
                        </div>
                        <div>
                            <label for="param-Sim_Days" class="flex justify-between items-center text-sm font-medium text-gray-300">
                                <span>ì‹œë®¬ë ˆì´ì…˜ ê¸°ê°„ (Sim_Days)</span>
                                <span id="val-Sim_Days" class="font-bold text-white text-base">365 ì¼</span>
                            </label>
                            <input type="range" id="param-Sim_Days" min="30" max="18250" value="365" step="30" class="w-full mt-2">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. ê·¸ë˜í”„ ë° í•´ì„ (R) -->
            <div class="lg:col-span-2 space-y-8">
                <!-- ì°¨íŠ¸ -->
                <div class="bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-4">ğŸ“ˆ ëŠ¥ë ¥ì¹˜(A) ì„±ì¥ ê³¡ì„ </h2>
                    <div class="chart-container">
                        <canvas id="growthChart"></canvas>
                    </div>
                </div>
                
                <!-- 1. ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ë¶„ì„ -->
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a6 6 0 00-6 6v3.586l-1.707 1.707A1 1 0 003 15v4a1 1 0 001 1h12a1 1 0 001-1v-4a1 1 0 00-.293-.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" /></svg>
                        ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ë¶„ì„
                    </h2>
                    <div id="analysis-text" class="text-lg text-gray-300 leading-relaxed space-y-3">
                        <!-- JSë¡œ ë™ì  ì—…ë°ì´íŠ¸ -->
                    </div>
                </div>

                <!-- 2. [ì‹ ê·œ] í•™ìŠµ ì „ëµ ì»¨ì„¤íŒ… ë³´ê³ ì„œ -->
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        í•™ìŠµ ì „ëµ ì»¨ì„¤íŒ… ë³´ê³ ì„œ
                    </h2>
                    <div id="consulting-report" class="text-base text-gray-300 leading-relaxed space-y-4">
                        <!-- JSë¡œ ë™ì  ì—…ë°ì´íŠ¸ -->
                    </div>
                </div>

                <!-- 3. [ì‹ ê·œ] ë³€ìˆ˜ ìƒì„¸ ì„¤ëª… ë° AI í™œìš©ë²• -->
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                    <h2 class="text-2xl font-bold text-white mb-6 pb-3 border-b border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M12 21v-1m-4-4H7M17 17h-1" />
                        </svg>
                        ë³€ìˆ˜ ìƒì„¸ ì„¤ëª…ê³¼ AI í•™ìŠµ ë„ìš°ë¯¸ë¥¼ í™œìš©í•œ ì„±ì¥ë¥  í–¥ìƒ
                    </h2>
                    <div id="variable-ai-guide" class="text-gray-300 leading-relaxed space-y-6">
                        <!-- JSë¡œ ë™ì  ì—…ë°ì´íŠ¸ -->
                    </div>
                </div>

            </div>
        </div>

        <!-- ì‹œë®¬ë ˆì´ì…˜ ì‘ë™ ì›ë¦¬ (ì•„ì½”ë””ì–¸) -->
        <section class="mt-24">
            <h2 class="text-4xl font-extrabold text-center mb-12 gradient-text">
                ì‹œë®¬ë ˆì´ì…˜ ì‘ë™ ì›ë¦¬
            </h2>
            <div class="max-w-4xl mx-auto space-y-4">
                
                <!-- ì•„ì½”ë””ì–¸ 1: ì¼ì¼ ì„±ì¥ë¥ (k) ê³„ì‚° -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">1. ì¼ì¼ ì„±ì¥ë¥  (k) ê³„ì‚°</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ë§¤ì¼ì˜ 'ì„±ì¥ë¥ (k)'ì€ ì´ í•™ìŠµ ì‹œê°„, ëª°ì…ë„, ì—°ì† í•™ìŠµ ì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.
                        </p>
                        <div class="formula">
                            $E_{eff} = T_d \cdot F_p$ (ìœ íš¨ í•™ìŠµ ì‹œê°„)
                            <br>
                            $C_{bonus} = 1 + (w_c \cdot T_c)$ (ì—°ì† í•™ìŠµ ë³´ë„ˆìŠ¤)
                            <br>
                            $k = B \cdot E_{eff} \cdot C_{bonus}$
                        </div>
                        <ul class="list-disc list-outside pl-6 mt-4 space-y-2">
                            <li>$k$: ê·¸ë‚ ì˜ ìµœì¢… ì„±ì¥ë¥  (ì‹œë®¬ë ˆì´ì…˜ì˜ í•µì‹¬ ë³€ìˆ˜)</li>
                            <li>$B$: ê¸°ë³¸ í•™ìŠµ íš¨ìœ¨ (ìƒìˆ˜)</li>
                            <li>$T_d$: ì´ í•™ìŠµ ì‹œê°„, $F_p$: ëª°ì…ë„, $T_c$: ì—°ì† í•™ìŠµ ì‹œê°„</li>
                        </ul>
                    </div>
                </div>
                
                <!-- ì•„ì½”ë””ì–¸ 2: ë¡œì§€ìŠ¤í‹± ì„±ì¥ ëª¨ë¸ -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">2. ë¡œì§€ìŠ¤í‹± ì„±ì¥ ëª¨ë¸ (ì´ì‚°í˜•)</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ì¼ì¼ 'ëŠ¥ë ¥ì¹˜ ë³€í™”ëŸ‰($\Delta A$)'ì€ ì–´ì œì˜ ëŠ¥ë ¥ì¹˜($A_{t-1}$)ì™€ ì„±ì¥ í•œê³„($L$)ì— ì˜í•´ ê²°ì •ë©ë‹ˆë‹¤. ì´ëŠ” ì „í˜•ì ì¸ ë¡œì§€ìŠ¤í‹± ì„±ì¥ ê³µì‹ì…ë‹ˆë‹¤.
                        </p>
                        <div class="formula">
                            $\Delta A = k \cdot A_{t-1} \cdot (1 - \frac{A_{t-1}}{L})$
                        </div>
                        <ul class="list-disc list-outside pl-6 mt-4 space-y-2">
                            <li>$\Delta A$: í•˜ë£¨ ë™ì•ˆì˜ ëŠ¥ë ¥ì¹˜ ì„±ì¥ëŸ‰</li>
                            <li>$k$: 1ë²ˆì—ì„œ ê³„ì‚°ëœ ì¼ì¼ ì„±ì¥ë¥ </li>
                            <li>$A_{t-1}$: ì–´ì œì˜ ëŠ¥ë ¥ì¹˜</li>
                            <li>$L$: ìµœëŒ€ ëŠ¥ë ¥ì¹˜ (ì„±ì¥ í•œê³„)</li>
                        </ul>
                    </div>
                </div>

                <!-- ì•„ì½”ë””ì–¸ 3: ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„ -->
                <div class="accordion-item bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <button class="accordion-button w-full flex justify-between items-center text-left p-6">
                        <span class="text-xl font-semibold text-gray-100">3. ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„</span>
                        <svg class="w-6 h-6 text-gray-400 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-6 pb-6 text-lg">
                        <p class="text-gray-300 leading-relaxed mb-4">
                            ì‹œë®¬ë ˆì´ì…˜ì€ $Sim\_Days$ (ì˜ˆ: 365ì¼) ë™ì•ˆ ë§¤ì¼ ë‹¤ìŒ ê³„ì‚°ì„ ë°˜ë³µí•©ë‹ˆë‹¤.
                        </p>
                        <div class="formula">
                            $A_t = A_{t-1} + \Delta A$
                        </div>
                        <p class="text-gray-400 mt-4">
                            ì´ ê³¼ì •ì„ ë°˜ë³µí•˜ì—¬ ë§¤ì¼ì˜ ëŠ¥ë ¥ì¹˜($A$)ë¥¼ ê³„ì‚°í•˜ê³  ê·¸ë˜í”„ë¡œ ê·¸ë¦½ë‹ˆë‹¤. (ë‹¨, $A_t$ëŠ” $L$ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.)
                        </p>
                    </div>
                </div>

            </div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', initializeApp);

        let growthChart; 
        const inputs = {};
        const values = {};
        const paramIds = [
            'total_time', 'focus_level', 'continuous_time', 
            'A0', 'L', 'B', 'wc', 'Sim_Days'
        ];

        // --- 1. ì‹œë®¬ë ˆì´ì…˜ í•µì‹¬ ë¡œì§ ---

        function calculateKDaily(params) {
            const { total_time, focus_level, continuous_time, B, wc } = params;
            const effective_hours = total_time * focus_level;
            const continuity_bonus = 1 + (wc * continuous_time);
            const k_value = B * effective_hours * continuity_bonus;
            return k_value;
        }

        function runSimulation(params, k_scenario) {
            const { A0, L, Sim_Days } = params;
            let ability_history = [A0];
            let days = [0];
            let current_ability = A0;

            for (let day = 1; day <= Sim_Days; day++) {
                let growth = 0;
                if (current_ability > 0 && current_ability < L) {
                    const logistic_factor = current_ability * (1 - (current_ability / L));
                    growth = k_scenario * logistic_factor;
                }
                current_ability += growth;
                current_ability = Math.min(Math.max(current_ability, 0), L);
                ability_history.push(current_ability);
                days.push(day);
            }
            return { days, ability_history };
        }

        // --- 2. UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ---

        function updateChart(data) {
            const chartCanvas = document.getElementById('growthChart')?.getContext('2d');
            if (!chartCanvas) return;

            const L = parseFloat(inputs.L.value);
            const line_50 = new Array(data.days.length).fill(L * 0.5);
            const line_90 = new Array(data.days.length).fill(L * 0.9);
            const Sim_Days = parseFloat(inputs.Sim_Days.value);
            const labelStep = Math.max(30, Math.ceil(Sim_Days / 12 / 30) * 30); 

            try {
                if (growthChart) {
                    growthChart.data.labels = data.days;
                    growthChart.data.datasets[0].data = data.ability_history;
                    growthChart.data.datasets[1].data = line_50;
                    growthChart.data.datasets[2].data = line_90;
                    growthChart.data.datasets[1].borderColor = '#3B82F6'; // 50% = Blue
                    growthChart.data.datasets[2].borderColor = '#EF4444'; // 90% = Red
                    growthChart.options.scales.y.max = L; 
                    growthChart.options.scales.x.ticks.callback = function(value, index, values) {
                        return (index % labelStep === 0) ? `${data.days[index]}ì¼` : null;
                    };
                    growthChart.update();
                } else {
                    growthChart = new Chart(chartCanvas, {
                        type: 'line',
                        data: {
                            labels: data.days,
                            datasets: [
                                {
                                    label: 'ëŠ¥ë ¥ì¹˜ (A)',
                                    data: data.ability_history,
                                    borderColor: '#2DD4BF', // Teal-500
                                    backgroundColor: '#2DD4BF30',
                                    borderWidth: 3,
                                    fill: true,
                                    tension: 0.1
                                },
                                {
                                    label: '50% ë‹¬ì„±ì„ ',
                                    data: line_50,
                                    borderColor: '#3B82F6', // Blue-500
                                    borderWidth: 1.5,
                                    borderDash: [5, 5], 
                                    fill: false,
                                    pointRadius: 0
                                },
                                {
                                    label: '90% ë‹¬ì„±ì„ ',
                                    data: line_90,
                                    borderColor: '#EF4444', // Red-500
                                    borderWidth: 1.5,
                                    borderDash: [5, 5], 
                                    fill: false,
                                    pointRadius: 0
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'top', labels: { color: '#E5E7EB', font: { size: 14 } } },
                                tooltip: { mode: 'index', intersect: false, callbacks: { 
                                    title: (tooltipItems) => `${tooltipItems[0].label} ì¼ì°¨`,
                                    label: (tooltipItem) => `${tooltipItem.dataset.label || ''}: ${parseFloat(tooltipItem.raw).toFixed(1)}`
                                } }
                            },
                            scales: {
                                x: {
                                    title: { display: true, text: 'ì‹œê°„ (ì¼)', color: '#9CA3AF' },
                                    ticks: {
                                        color: '#9CA3AF',
                                        callback: function(value, index, values) {
                                            return (index % labelStep === 0) ? `${data.days[index]}ì¼` : null;
                                        },
                                        maxRotation: 0,
                                        autoSkip: false
                                    },
                                    grid: { color: '#374151' }
                                },
                                y: {
                                    title: { display: true, text: 'ëŠ¥ë ¥ì¹˜ (A)', color: '#9CA3AF' },
                                    ticks: { color: '#9CA3AF' },
                                    grid: { color: '#374151' },
                                    min: 0,
                                    max: L
                                }
                            },
                            elements: { point: { radius: 0, hitRadius: 10, hoverRadius: 5 } }
                        }
                    });
                }
            } catch (error) {
                console.error("[Chart Error]", error);
            }
        }

        function updateAnalysis(data, params, k_value) {
            const analysisText = document.getElementById('analysis-text');
            if (!analysisText) return;
            
            const { L, Sim_Days } = params;
            const L_50 = L * 0.5;
            const L_90 = L * 0.9;

            const day_50 = data.ability_history.findIndex(val => val >= L_50);
            const day_90 = data.ability_history.findIndex(val => val >= L_90);

            const day_50_text = (day_50 > 0) ? `ì•½ <span class="text-white font-bold">${day_50}</span> ì¼ì°¨ì— ${L_50.toFixed(0)} ë‹¬ì„±` : `<span class="text-red-400">${Sim_Days.toFixed(0)}</span>ì¼ ë‚´ ë„ë‹¬ ëª»í•¨`;
            const day_90_text = (day_90 > 0) ? `ì•½ <span class="text-white font-bold">${day_90}</span> ì¼ì°¨ì— ${L_90.toFixed(0)} ë‹¬ì„±` : `<span class="text-red-400">${Sim_Days.toFixed(0)}</span>ì¼ ë‚´ ë„ë‹¬ ëª»í•¨`;

            analysisText.innerHTML = `
                <p>ê³„ì‚°ëœ ì¼ì¼ <strong>ì„±ì¥ë¥  (k)</strong>: <span class="text-teal-300 font-bold text-2xl">${k_value.toFixed(4)}</span></p>
                <p class="mt-4 pt-4 border-t border-gray-600"><strong>50% ë„ë‹¬ (A=${L_50.toFixed(0)}):</strong><br>${day_50_text}</p>
                <p class="mt-2"><strong>90% ë„ë‹¬ (A=${L_90.toFixed(0)}):</strong><br>${day_90_text}</p>
            `;
        }

        /**
         * [ì‹ ê·œ] ì»¨ì„¤íŒ… ë³´ê³ ì„œ ì—…ë°ì´íŠ¸
         */
        function updateConsultingReport(data, params, k_value) {
            const reportDiv = document.getElementById('consulting-report');
            if (!reportDiv) return;

            const { total_time, focus_level, continuous_time, L, Sim_Days } = params;
            const day_50 = data.ability_history.findIndex(val => val >= L * 0.5);
            const day_90 = data.ability_history.findIndex(val => val >= L * 0.9);

            let diagnosis = "";
            if (k_value > 0.015) {
                diagnosis = `í˜„ì¬ ì„¤ì •(k=${k_value.toFixed(4)})ì€ <strong class="text-teal-300">ë§¤ìš° ê³µê²©ì ì¸ ê³ ì† ì„±ì¥</strong> ìœ í˜•ì…ë‹ˆë‹¤. ë‹¨ê¸°ê°„ì— í­ë°œì ì¸ ì„±ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” ì´ìƒì ì¸ ì„¤ì •ì…ë‹ˆë‹¤.`;
            } else if (k_value > 0.007) {
                diagnosis = `í˜„ì¬ ì„¤ì •(k=${k_value.toFixed(4)})ì€ <strong class="text-sky-300">ì•ˆì •ì ì¸ ì„±ì¥</strong> ìœ í˜•ì…ë‹ˆë‹¤. ê¾¸ì¤€íˆ ìš°ìƒí–¥í•˜ëŠ” ëª¨ë²”ì ì¸ í•™ìŠµ ê³¡ì„ ì…ë‹ˆë‹¤.`;
            } else if (k_value > 0.003) {
                diagnosis = `í˜„ì¬ ì„¤ì •(k=${k_value.toFixed(4)})ì€ <strong class="text-yellow-300">ë‹¤ì†Œ ë”ë”˜ ì„±ì¥</strong> ìœ í˜•ì…ë‹ˆë‹¤. ì„±ì¥ì´ ì •ì²´ë˜ê±°ë‚˜ í˜„ìƒ ìœ ì§€ì— ê·¸ì¹  ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.`;
            } else {
                diagnosis = `í˜„ì¬ ì„¤ì •(k=${k_value.toFixed(4)})ì€ <strong class="text-red-400">ì„±ì¥ ì •ì²´</strong> ìœ í˜•ì…ë‹ˆë‹¤. íˆ¬ì…í•˜ëŠ” ë…¸ë ¥ ëŒ€ë¹„ ì„±ê³¼ê°€ ê±°ì˜ ì—†ê±°ë‚˜, ëŠ¥ë ¥ì¹˜ê°€ í•˜ë½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
            }

            let bottleneck = "";
            if (focus_level < 0.6) {
                bottleneck = `ê°€ì¥ ì‹œê¸‰í•œ ë¬¸ì œëŠ” <strong class="text-red-400">ëª°ì…ë„(F_p: ${(focus_level * 100).toFixed(0)}%)</strong>ì…ë‹ˆë‹¤. ${total_time.toFixed(1)}ì‹œê°„ì„ ì•‰ì•„ìˆì–´ë„, ì‹¤ì œ ìœ íš¨ í•™ìŠµ ì‹œê°„ì€ ${(total_time * focus_level).toFixed(1)}ì‹œê°„ì— ë¶ˆê³¼í•©ë‹ˆë‹¤. 'ì–‘'ë³´ë‹¤ 'ì§ˆ'ì„ ë¨¼ì € í™•ë³´í•´ì•¼ í•©ë‹ˆë‹¤.`;
            } else if (total_time < 4) {
                bottleneck = `ì ˆëŒ€ì ì¸ <strong class="text-red-400">í•™ìŠµ ì‹œê°„(T_d: ${total_time.toFixed(1)}ì‹œê°„)</strong>ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ëª°ì…ë„ê°€ ì•„ë¬´ë¦¬ ë†’ì•„ë„, íˆ¬ì…ë˜ëŠ” ì´ëŸ‰ì´ ì ì–´ kê°’ì´ ë‚®ê²Œ ìœ ì§€ë©ë‹ˆë‹¤.`;
            } else if (continuous_time < 1.0) {
                bottleneck = `ì—°ì† í•™ìŠµ(T_c: ${continuous_time.toFixed(1)}ì‹œê°„)ì„ í†µí•œ <strong class="text-yellow-300">ë³´ë„ˆìŠ¤(w_c)</strong>ë¥¼ ê±°ì˜ í™œìš©í•˜ì§€ ëª»í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì¦ì€ íœ´ì‹ì€ ëª°ì…ì„ ë°©í•´í•˜ê³  kê°’ì˜ ì ì¬ë ¥ì„ ì–µì œí•©ë‹ˆë‹¤.`;
            } else {
                bottleneck = `í˜„ì¬ ì…ë ¥ ë³€ìˆ˜ë“¤ì€ <strong class="text-green-300">ë§¤ìš° ê· í˜• ì¡íŒ ìƒíƒœ</strong>ì…ë‹ˆë‹¤. kê°’ì„ ë” ë†’ì´ë ¤ë©´, ê¸°ë³¸ íš¨ìœ¨(B) ìì²´ë¥¼ ë†’ì´ëŠ” ì§ˆì  ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤. (ì•„ë˜ AI í™œìš©ë²• ì°¸ê³ )`;
            }

            let result_analysis = "";
            if (day_90 > 0) {
                result_analysis = `ì´ ì¶”ì„¸ë¼ë©´ <strong class="text-white">${day_90}</strong>ì¼ ë§Œì— ì „ë¬¸ê°€ ìˆ˜ì¤€(90%)ì— ë„ë‹¬í•©ë‹ˆë‹¤. ì´ëŠ” ìƒìœ„ 1%ì˜ í•™ìŠµ ì†ë„ì…ë‹ˆë‹¤.`;
            } else if (day_50 > 0) {
                result_analysis = `ì „ë¬¸ê°€ ìˆ˜ì¤€(90%)ì€ ${Sim_Days.toFixed(0)}ì¼ ë‚´ ë„ë‹¬í•˜ê¸° ì–´ë µì§€ë§Œ, <strong class="text-white">${day_50}</strong>ì¼ ë§Œì— ì¤‘ê¸‰ì(50%) ìˆ˜ì¤€ì—ëŠ” ë„ë‹¬í•©ë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ì§€ì†í•´ì•¼ í•©ë‹ˆë‹¤.`;
            } else {
                result_analysis = `${Sim_Days.toFixed(0)}ì¼ì˜ ê¸°ê°„ ë™ì•ˆ ì¤‘ê¸‰ì(50%) ìˆ˜ì¤€ì—ë„ ë„ë‹¬í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. í•™ìŠµ ì „ëµì˜ <strong class="text-red-400">ì „ë©´ì ì¸ ì¬ê²€í† </strong>ê°€ í•„ìš”í•©ë‹ˆë‹¤.`;
            }
            
            const final_recommendation = (bottleneck.includes("ê· í˜• ì¡íŒ ìƒíƒœ"))
                ? "í˜„ì¬ ì „ëµì„ ìœ ì§€í•˜ë˜, AI ë„êµ¬ë¥¼ í™œìš©í•´ 'ê¸°ë³¸ íš¨ìœ¨(B)'ì„ ê·¹ëŒ€í™”í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤."
                : "ë¨¼ì € ìœ„ì—ì„œ ì§„ë‹¨ëœ í•µì‹¬ ë³‘ëª© í˜„ìƒì„ í•´ê²°í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤. ì‘ì€ ë³€ìˆ˜ í•˜ë‚˜ë§Œ ê³ ì³ë„ kê°’ì€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ìƒìŠ¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";

            reportDiv.innerHTML = `
                <p class="text-sm text-gray-400">30ë…„ ê²½ë ¥ êµìœ¡í•™ ì „ë¬¸ê°€ (AI)ê°€ í˜„ì¬ ì„¤ì •ì„ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í•œ ë³´ê³ ì„œì…ë‹ˆë‹¤.</p>
                <div class="mt-4">
                    <h3 class="text-lg font-semibold text-white">1. í˜„ì¬ ìƒíƒœ ì§„ë‹¨ (k-value)</h3>
                    <p>${diagnosis}</p>
                </div>
                <div class="mt-4">
                    <h3 class="text-lg font-semibold text-white">2. í•µì‹¬ ë³‘ëª© í˜„ìƒ ë¶„ì„</h3>
                    <p>${bottleneck}</p>
                </div>
                <div class="mt-4">
                    <h3 class="text-lg font-semibold text-white">3. ì„±ì¥ ì˜ˆì¸¡ ë° ìµœì¢… ì „ëµ</h3>
                    <p>${result_analysis}</p>
                    <p class="mt-2"><strong>[ìµœì¢… ì œì–¸]</strong>: ${final_recommendation}</p>
                </div>
            `;
        }

        /**
         * [ì‹ ê·œ] ë³€ìˆ˜ ê°€ì´ë“œ ë° AI í™œìš©ë²• ì—…ë°ì´íŠ¸
         */
        function updateVariableGuide(params, k_value) {
            const guideDiv = document.getElementById('variable-ai-guide');
            if (!guideDiv) return;

            const { total_time, focus_level, continuous_time, B, wc, L } = params;

            guideDiv.innerHTML = `
                <!-- T_d -->
                <div class="p-4 bg-gray-900 rounded-lg">
                    <h4 class="text-lg font-semibold text-sky-300">1. ì´ í•™ìŠµ ì‹œê°„ (T_d) <span class="text-sm font-normal text-white">(í˜„ì¬: ${total_time.toFixed(1)} ì‹œê°„)</span></h4>
                    <p class="text-sm text-gray-400 mt-1">í•˜ë£¨ì— í•™ìŠµì— íˆ¬ì…í•˜ëŠ” ì´ ì‹œê°„ì…ë‹ˆë‹¤. kê°’ì— ì§ì ‘ì ì¸ 'ì–‘'ì„ ê²°ì •í•©ë‹ˆë‹¤.</p>
                    <p class="text-sm mt-1"><strong>ì¶”ì²œ:</strong> ìµœì†Œ 4ì‹œê°„, ê³ ì† ì„±ì¥ì„ ìœ„í•´ 8ì‹œê°„ ì´ìƒ</p>
                    <p class="text-sm mt-1"><strong>AI í™œìš©ë²•:</strong> AIì—ê²Œ "í˜„ì¬ ë‚˜ì˜ kê°’(${k_value.toFixed(4)})ì„ 0.015ë¡œ ì˜¬ë¦¬ê³  ì‹¶ì–´. T_dë¥¼ ëª‡ ì‹œê°„ìœ¼ë¡œ ëŠ˜ë ¤ì•¼ í• ê¹Œ?"ë¼ê³  ë¬¼ì–´ë³´ê±°ë‚˜, "ë‚˜ì˜ í•˜ë£¨ ì¼ê³¼í‘œë¥¼ ì£¼ê³  ${total_time.toFixed(1)}ì‹œê°„ ëŒ€ì‹  8ì‹œê°„ì˜ í•™ìŠµ ì‹œê°„ì„ í™•ë³´í•  ìˆ˜ ìˆëŠ” ìŠ¤ì¼€ì¤„ì„ ìµœì í™”í•´ì¤˜"ë¼ê³  ìš”ì²­í•˜ì‹­ì‹œì˜¤.</p>
                </div>

                <!-- F_p -->
                <div class="p-4 bg-gray-900 rounded-lg">
                    <h4 class="text-lg font-semibold text-sky-300">2. í•™ìŠµ ëª°ì…ë„ (F_p) <span class="text-sm font-normal text-white">(í˜„ì¬: ${(focus_level * 100).toFixed(0)} %)</span></h4>
                    <p class="text-sm text-gray-400 mt-1">T_d ì¤‘ ì‹¤ì œ í•™ìŠµì— ëª°ì…í•œ ì‹œê°„ì˜ 'ë¹„ìœ¨'ì…ë‹ˆë‹¤. 10ì‹œê°„ì„ ì•‰ì•„ìˆì–´ë„ ëª°ì…ë„ê°€ 50%ë©´ ìœ íš¨ ì‹œê°„ì€ 5ì‹œê°„ì…ë‹ˆë‹¤. kê°’ì˜ 'ì§ˆ'ì„ ê²°ì •í•©ë‹ˆë‹¤.</p>
                    <p class="text-sm mt-1"><strong>ì¶”ì²œ:</strong> ìµœì†Œ 80%, ì´ìƒì ìœ¼ë¡œ 95% ì´ìƒ</p>
                    <p class="text-sm mt-1"><strong>AI í™œìš©ë²•:</strong> 'ë½€ëª¨ë„ë¡œ íƒ€ì´ë¨¸' ì‚¬ìš©ì„ ìë™í™”í•˜ê³ , í•™ìŠµ ì¤‘ ë°©í•´ ìš”ì†Œë¥¼ ì°¨ë‹¨í•˜ëŠ” í™˜ê²½ì„ AIì™€ í•¨ê»˜ ì„¤ì •í•˜ì‹­ì‹œì˜¤. AIì—ê²Œ "ë‚´ê°€ [ì£¼ì œ]ë¥¼ í•™ìŠµí•  ë•Œ ëª°ì…ë„ê°€ ë–¨ì–´ì§€ëŠ” ì§•í›„ê°€ ë³´ì´ë©´, ì¦‰ì‹œ ì•Œë ¤ì£¼ê³  ê´€ë ¨ëœ í€´ì¦ˆë¥¼ ë‚´ì¤˜"ë¼ê³  ìš”ì²­í•˜ì—¬ ìƒí˜¸ì‘ìš©ì„ ìœ ì§€í•˜ì‹­ì‹œì˜¤.</p>
                </div>

                <!-- T_c -->
                <div class="p-4 bg-gray-900 rounded-lg">
                    <h4 class="text-lg font-semibold text-sky-300">3. ìµœëŒ€ ì—°ì† í•™ìŠµ ì‹œê°„ (T_c) <span class="text-sm font-normal text-white">(í˜„ì¬: ${continuous_time.toFixed(1)} ì‹œê°„)</span></h4>
                    <p class="text-sm text-gray-400 mt-1">'ì—°ì† ë³´ë„ˆìŠ¤(C_bonus)'ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. ë‡Œê°€ íŠ¹ì • ì£¼ì œì— ê¹Šì´ ë¹ ì ¸ë“œëŠ” 'ë”¥ë‹¤ì´ë¸Œ' ìƒíƒœë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.</p>
                    <p class="text-sm mt-1"><strong>ì¶”ì²œ:</strong> 1.5 ~ 3.0 ì‹œê°„. (ë„ˆë¬´ ê¸¸ë©´ ì˜¤íˆë ¤ ëª°ì…ë„(F_p)ê°€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŒ)</p>
                    <p class="text-sm mt-1"><strong>AI í™œìš©ë²•:</strong> AIì—ê²Œ "2ì‹œê°„ ë¶„ëŸ‰ì˜ [ì£¼ì œ]ì— ëŒ€í•œ ë”¥ë‹¤ì´ë¸Œ í•™ìŠµ ì„¸ì…˜ì„ ì„¤ê³„í•´ì¤˜. ì¤‘ê°„ì— íë¦„ì´ ëŠê¸°ì§€ ì•Šë„ë¡ ê´€ë ¨ ê°œë…ì„ ìˆœì„œëŒ€ë¡œ ë°°ì—´í•´ì¤˜"ë¼ê³  ìš”ì²­í•˜ì—¬ 'ì—°ì† í•™ìŠµ' ìì²´ì˜ ì§ˆì„ ë†’ì´ì‹­ì‹œì˜¤.</p>
                </div>

                <!-- B -->
                <div class="p-4 bg-gray-900 rounded-lg">
                    <h4 class="text-lg font-semibold text-white">4. ê¸°ë³¸ í•™ìŠµ íš¨ìœ¨ (B) <span class="text-sm font-normal text-white">(í˜„ì¬: ${B.toFixed(3)})</span></h4>
                    <p class="text-sm text-gray-400 mt-1">ê°€ì¥ ì¤‘ìš”í•œ ìƒìˆ˜. ë™ì¼í•œ ì‹œê°„(T_d)ê³¼ ëª°ì…ë„(F_p)ë¥¼ íˆ¬ì…í•´ë„, ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ ì§€ì‹ìœ¼ë¡œ ë³€í™˜ë˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. (ì˜ˆ: ì˜¬ë°”ë¥¸ êµì¬, ì¢‹ì€ ê°•ì˜, íš¨ìœ¨ì ì¸ ì•”ê¸°ë²•)</p>
                    <p class="text-sm mt-1"><strong>ì¶”ì²œ:</strong> 0.01 ì´ìƒ. ì´ ê°’ì´ ë†’ìœ¼ë©´ ì²œì¬, ë‚®ìœ¼ë©´ ë¹„íš¨ìœ¨ì ì¸ í•™ìŠµ.</p>
                    <p class="text-sm mt-1"><strong>AI í™œìš©ë²•:</strong> <strong>Bê°’ì„ ê·¹ëŒ€í™”í•˜ëŠ” ê²ƒì´ AI í™œìš©ì˜ í•µì‹¬ì…ë‹ˆë‹¤.</strong> AIì—ê²Œ "ë‚´ê°€ [ì£¼ì œ]ë¥¼ L=${L.toFixed(0)} ìˆ˜ì¤€ê¹Œì§€ ë°°ìš°ë ¤ í•´. ê°€ì¥ íš¨ìœ¨ì ì¸ í•™ìŠµ ë¡œë“œë§µ(Bê°€ ë†’ì€)ì„ ì§œì¤˜", "ì´ ê°œë…ì„ 'íŒŒì¸ë§Œ ê¸°ë²•'ìœ¼ë¡œ ì„¤ëª…í•´ì¤˜", "ê´€ë ¨ëœ 'ë©”íƒ€ì¸ì§€' ì§ˆë¬¸ 5ê°œë§Œ í•´ì¤˜"ë¼ê³  ìš”ì²­í•˜ì—¬ í•™ìŠµ íš¨ìœ¨ ìì²´ë¥¼ ê·¹ëŒ€í™”í•˜ì‹­ì‹œì˜¤.</p>
                </div>

                <!-- w_c -->
                <div class="p-4 bg-gray-900 rounded-lg">
                    <h4 class="text-lg font-semibold text-white">5. ì—°ì† ë³´ë„ˆìŠ¤ ê°€ì¤‘ì¹˜ (w_c) <span class="text-sm font-normal text-white">(í˜„ì¬: ${wc.toFixed(2)})</span></h4>
                    <p class="text-sm text-gray-400 mt-1">T_c(ì—°ì† ì‹œê°„)ê°€ ì–¼ë§ˆë‚˜ í° ë³´ë„ˆìŠ¤ë¥¼ ì¤„ì§€ ê²°ì •í•˜ëŠ” ìƒìˆ˜ì…ë‹ˆë‹¤. ì´ ê°’ì´ 0ì´ë©´ T_cëŠ” ì•„ë¬´ ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                    <p class="text-sm mt-1"><strong>ì¶”ì²œ:</strong> 0.2 ~ 0.5. (ì£¼ì œì— ë”°ë¼ ë‹¤ë¦„)</p>
                    <p class="text-sm mt-1"><strong>AI í™œìš©ë²•:</strong> AIì—ê²Œ "ë‚˜ëŠ” [ì°½ì˜ì ì¸ ì‘ì—…]ì„ í•˜ê³  ìˆì–´. T_c ë³´ë„ˆìŠ¤ê°€ í°(w_c=0.5) ì‘ì—…ì´ë‹ˆ, 2ì‹œê°„ ë™ì•ˆ ë°©í•´ë°›ì§€ ì•Šë„ë¡ ë³´ì¡°í•´ì¤˜"ë¼ê³  ì„ ì–¸í•˜ë©° í•™ìŠµ í™˜ê²½ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            `;
        }

        // --- 3. ìœ í‹¸ë¦¬í‹° ë° ë©”ì¸ ì‹¤í–‰ ---

        function runFullSimulation() {
            const params = {};
            paramIds.forEach(id => {
                params[id] = parseFloat(inputs[id].value);
            });

            // kê°’ ê³„ì‚° (í•œ ë²ˆë§Œ)
            const k_value = calculateKDaily(params);

            // ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
            const data = runSimulation(params, k_value);
            
            // ëª¨ë“  UI ì„¹ì…˜ ì—…ë°ì´íŠ¸
            updateChart(data);
            updateAnalysis(data, params, k_value);
            updateConsultingReport(data, params, k_value); // [ì‹ ê·œ]
            updateVariableGuide(params, k_value); // [ì‹ ê·œ]
        }

        function updateSliderLabel(key, value) {
            if (values[key]) {
                if (key === 'total_time' || key === 'continuous_time') {
                    values[key].textContent = `${value.toFixed(1)} ì‹œê°„`;
                } else if (key === 'focus_level') {
                    values[key].textContent = `${(value * 100).toFixed(0)} %`;
                } else if (key === 'B') {
                    values[key].textContent = value.toFixed(3);
                } else if (key === 'wc') {
                    values[key].textContent = value.toFixed(2);
                } else if (key === 'Sim_Days') {
                    values[key].textContent = `${value.toFixed(0)} ì¼`;
                } else { // A0, L
                    values[key].textContent = value.toFixed(0);
                }
            }
        }

        function updateSimDaysStep(currentValue) {
            const slider = inputs.Sim_Days;
            if (!slider) return;

            let newStep = 30; // ê¸°ë³¸ê°’
            if (currentValue < 1825) { // 5ë…„ ë¯¸ë§Œ
                newStep = 5;
            } else if (currentValue < 3650) { // 10ë…„ ë¯¸ë§Œ
                newStep = 7;
            } else if (currentValue < 7300) { // 20ë…„ ë¯¸ë§Œ
                newStep = 30;
            } else if (currentValue < 10950) { // 30ë…„ ë¯¸ë§Œ
                newStep = 60;
            } else if (currentValue < 14600) { // 40ë…„ ë¯¸ë§Œ
                newStep = 90;
            } else { // 50ë…„ ì´í•˜
                newStep = 120;
            }
            slider.step = newStep;
        }

        function initializeApp() {
            console.log("DOM ë¡œë“œ ì™„ë£Œ. ì•± ì´ˆê¸°í™” ì‹œì‘...");
            
            paramIds.forEach(id => {
                inputs[id] = document.getElementById(`param-${id}`);
                values[id] = document.getElementById(`val-${id}`);
            });

            paramIds.forEach(id => {
                if(inputs[id]) {
                    inputs[id].addEventListener('input', (event) => {
                        const value = parseFloat(event.target.value);
                        if (id === 'Sim_Days') {
                            updateSimDaysStep(value);
                        }
                        updateSliderLabel(id, value);
                        runFullSimulation(); 
                    });
                }
            });
            
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('svg');
                    const isOpening = content.style.display !== 'block';
                    
                    document.querySelectorAll('.accordion-content').forEach(c => c.style.display = 'none');
                    document.querySelectorAll('.accordion-button svg').forEach(i => i.style.transform = 'rotate(0deg)');

                    if (isOpening) {
                        content.style.display = 'block';
                        icon.style.transform = 'rotate(180deg)';
                    }
                });
            });

            // ì´ˆê¸° ì‹¤í–‰
            runFullSimulation();
            console.log("ì•± ì´ˆê¸°í™” ì™„ë£Œ.");
        }
        
    </script>
</body>
</html>

